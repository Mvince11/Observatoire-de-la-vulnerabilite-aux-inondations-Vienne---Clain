<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Carte Intercative – Observatoire de la vulnérabilité aux inondations Vienne - Clain</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b663525e4b92bb903b2199e2d401bf36.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-02fdb461c123516f218d67c91b09032a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="site_libs/quarto-dashboard/stickythead.js"></script>
<script src="site_libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="site_libs/quarto-dashboard/components.js"></script>
<link href="site_libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>

<script src="site_libs/react-18.2.0/react.min.js"></script>

<script src="site_libs/react-18.2.0/react-dom.min.js"></script>

<script src="site_libs/reactwidget-2.0.0/react-tools.js"></script>

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">

<script src="site_libs/reactable-binding-0.4.4/reactable.js"></script>

<script src="js/maplibre.js"></script>
<link href="js/maplibre.css" rel="stylesheet">
<script src="js/jquery_3.5.min.js" type="text/javascript"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="js/photon-geocoder-autocomplete.min.css" type="text/css">
<script src="js/photon-geocoder-autocomplete.min.js" type="text/javascript"></script>


</head>

<body class="quarto-dashboard nav-fixed dashboard-fill dashboard-sidebar fullcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-xxl " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./Images/logo_porteurs_projet_transparent.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Observatoire de la vulnérabilité aux inondations Vienne - Clain</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mieux_comprendre.html"> 
<span class="menu-text">Les inondations</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-objectif-n°1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Objectif n°1</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-objectif-n°1">    
        <li class="dropdown-header">Objectif n°1 : Augmenter la sécurité des populations</li>
        <li>
    <a class="dropdown-item" href="./batiments_plain_pied.html">
 <span class="dropdown-text">Bâtiments plain-pied</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./etablissements_sensibles.html">
 <span class="dropdown-text">Etablissements sensibles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./enjeux_susceptibles_dysfonctionner.html">
 <span class="dropdown-text">Etablissements utiles à la gestion de crise</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./campings.html">
 <span class="dropdown-text">Campings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./routes.html">
 <span class="dropdown-text">Routes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./pcs.html">
 <span class="dropdown-text">Plan communal de sauvegarde (PCS)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dicrim.html">
 <span class="dropdown-text">Document d’information communal sur les risques majeurs (DICRIM)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-objectif-n°2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Objectif n°2</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-objectif-n°2">    
        <li class="dropdown-header">Objectif n°2 : Stabiliser/réduire le coût des dommages</li>
        <li>
    <a class="dropdown-item" href="./dommages_habitations.html">
 <span class="dropdown-text">Dommages aux habitations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dommages_entreprises.html">
 <span class="dropdown-text">Dommages aux entreprises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dommages_cultures.html">
 <span class="dropdown-text">Dommages aux cultures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./monuments.html">
 <span class="dropdown-text">Patrimoines et monuments historiques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./espaces_naturels.html">
 <span class="dropdown-text">Espaces naturels</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./installations_polluantes.html">
 <span class="dropdown-text">Installations polluantes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./eau_potable.html">
 <span class="dropdown-text">Station d’alimentation en eau potable</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-objectif-n°3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Objectif n°3</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-objectif-n°3">    
        <li class="dropdown-header">Objectif n°3 : Raccourcir le délai de retour à la normale</li>
        <li>
    <a class="dropdown-item" href="./habitants_zones_inondables.html">
 <span class="dropdown-text">Nombre et proportion d’habitants en zone inondable</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-propos" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Â propos</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-propos">    
        <li>
    <a class="dropdown-item" href="https://www.eptb-vienne.fr" target="_blank">
 <span class="dropdown-text">EPTB-vienne.fr</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://fr.linkedin.com/company/eptb-vienne" title="LinkedIn" class="quarto-navigation-tool px-1" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
    <a href="https://eptb-vienne.fr/contact" title="Nous contacter" class="quarto-navigation-tool px-1" aria-label="Nous contacter"><i class="bi bi-envelope"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       

      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">Carte Intercative</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-cartographie" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#cartographie" data-scrolling="false" href="#cartographie" aria-controls="cartographie" aria-selected="true"><span class="nav-link-text">Cartographie</span></a></li><li class="nav-item" role="presentation"><a id="tab-informations-relatives-à-lindicateur" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#informations-relatives-à-lindicateur" data-scrolling="false" href="#informations-relatives-à-lindicateur" aria-controls="informations-relatives-à-lindicateur" aria-selected="false"><span class="nav-link-text">Informations relatives à l’indicateur</span></a></li><li class="nav-item" role="presentation"><a id="tab-bâtiments-en-3d-mode-demploi" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#bâtiments-en-3d-mode-demploi" data-scrolling="false" href="#bâtiments-en-3d-mode-demploi" aria-controls="bâtiments-en-3d-mode-demploi" aria-selected="false"><span class="nav-link-text">Bâtiments en 3D : Mode d’emploi</span></a></li></ul></div></div>
</nav>
</header></header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill quarto-dashboard-pages dashboard-sidebar-container">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<div class="bslib-sidebar-layout html-fill-item html-fill-container" data-bslib-sidebar-open="desktop" data-bslib-sidebar-init="true" data-bslib-sidebar-border="false" data-bslib-sidebar-border-radius="false"><div class="main html-fill-container html-fill-item"><div class="sidebar-content html-fill-item html-fill-container">
<div class="tab-content bslib-grid html-fill-item html-fill-container" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div id="cartographie" class="dashboard-page tab-pane show active html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-cartographie">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 60fr) minmax(3em, 40fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="cell hidden html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb2" data-startfrom="83" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 82;"><span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>bassin_vienne <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/bassin_vienne.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>departement <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/departement.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>region <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/region.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>epci <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/epci.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>perimetre <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/perimetre.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>slgri <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/slgri.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>tri <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/tri.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>zone_inondable <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/zone_inondable.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a><span class="co">//indicateurs = FileAttachment("layers/indicateurs.json").json();</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>cours_d_eau <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/cours_d_eau.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>indicateursGeojson <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/indicateurs.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>batiments <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/batiments_hauteur.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-9" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-10" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-2-11" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-fill="true" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container" style="padding: 0px;">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb3" data-startfrom="102" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 101;"><span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>map <span class="op">=</span> {</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="map-container" id="map" style="height: 665px; width: 100%;"&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>  <span class="kw">yield</span> container<span class="op">;</span></span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span> <span class="kw">const</span> sourcePlanIGN <span class="op">=</span> { <span class="op">--&gt;</span></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span>   <span class="dt">style</span><span class="op">:</span> <span class="st">'normal'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span>   <span class="dt">format</span><span class="op">:</span> <span class="st">'image/png'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span>   <span class="dt">layer</span><span class="op">:</span> <span class="st">'GEOGRAPHICALGRIDSYSTEMS.PLANIGNV2'</span> <span class="op">--&gt;</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;!--</span> }<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sourceOrtho <span class="op">=</span> {</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> <span class="st">'normal'</span><span class="op">,</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> <span class="st">'image/jpeg'</span><span class="op">,</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layer</span><span class="op">:</span> <span class="st">'HR.ORTHOIMAGERY.ORTHOPHOTOS'</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sourceOSM <span class="op">=</span> {</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tiles</span><span class="op">:</span> <span class="st">'https://tile.openstreetmap.org/{z}/{x}/{y}.png'</span><span class="op">,</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>    <span class="dt">attribution</span><span class="op">:</span> <span class="st">'© &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'</span><span class="op">,</span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>    <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">19</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> <span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">Map</span>({</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>    <span class="dt">container</span><span class="op">:</span> container<span class="op">,</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> <span class="st">'https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json'</span><span class="op">,</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> <span class="dt">center</span><span class="op">:</span> [<span class="op">-</span><span class="fl">0.04</span><span class="op">,</span> <span class="fl">46.3051</span>]<span class="op">,</span>  <span class="op">--&gt;</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>    <span class="dt">zoom</span><span class="op">:</span> <span class="dv">11</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">addControl</span>(<span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">FullscreenControl</span>()<span class="op">,</span> <span class="st">'top-right'</span>)<span class="op">;</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">addControl</span>(<span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">NavigationControl</span>({ <span class="dt">visualizePitch</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">,</span> <span class="st">'top-left'</span>)<span class="op">;</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">addControl</span>(<span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">ScaleControl</span>({ <span class="dt">maxWidth</span><span class="op">:</span> <span class="dv">80</span><span class="op">,</span> <span class="dt">unit</span><span class="op">:</span> <span class="st">'metric'</span> }))<span class="op">;</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> toggleStyle <span class="op">=</span> (useOrtho) <span class="kw">=&gt;</span> {</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (useOrtho) {</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'orthoIGN'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'visible'</span>)<span class="op">;</span></span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'OSM'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'orthoIGN'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'none'</span>)<span class="op">;</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">setLayoutProperty</span>(<span class="st">'OSM'</span><span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> <span class="st">'visible'</span>)<span class="op">;</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>  map<span class="op">.</span><span class="fu">on</span>(<span class="st">'load'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">fitBounds</span>(</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>      [<span class="op">-</span><span class="fl">0.04</span><span class="op">,</span> <span class="fl">46.3051</span>]<span class="op">,</span>   <span class="co">// Sud-Ouest</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>      [<span class="fl">0.7741</span><span class="op">,</span> <span class="fl">46.8565</span>]   <span class="co">// Nord-Est</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>      <span class="dt">padding</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>      <span class="dt">linear</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>      <span class="dt">duration</span><span class="op">:</span> <span class="dv">0</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ajout des fonds raster IGN</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> map<span class="op">.</span><span class="fu">addSource</span>(<span class="st">'raster-planign'</span><span class="op">,</span> { <span class="op">--&gt;</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">tiles</span><span class="op">:</span> [ <span class="op">--&gt;</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>     <span class="vs">`https://data.geopf.fr/wmts?SERVICE=WMTS&amp;style=</span><span class="sc">${</span>sourcePlanIGN<span class="op">.</span><span class="at">style</span><span class="sc">}</span><span class="vs">&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;format=</span><span class="sc">${</span>sourcePlanIGN<span class="op">.</span><span class="at">format</span><span class="sc">}</span><span class="vs">&amp;layer=</span><span class="sc">${</span>sourcePlanIGN<span class="op">.</span><span class="at">layer</span><span class="sc">}</span><span class="vs">&amp;tilematrixset=PM&amp;TileMatrix={z}&amp;TileCol={x}&amp;TileRow={y}`</span> <span class="op">--&gt;</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   ]<span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">tileSize</span><span class="op">:</span> <span class="dv">256</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">attribution</span><span class="op">:</span> <span class="st">'© &lt;a href="https://www.ign.fr/"&gt;IGN&lt;/a&gt;'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">22</span> <span class="op">--&gt;</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> })<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addSource</span>(<span class="st">'raster-ortho'</span><span class="op">,</span> {</span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tiles</span><span class="op">:</span> [</span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>        <span class="vs">`https://data.geopf.fr/wmts?SERVICE=WMTS&amp;style=</span><span class="sc">${</span>sourceOrtho<span class="op">.</span><span class="at">style</span><span class="sc">}</span><span class="vs">&amp;VERSION=1.0.0&amp;REQUEST=GetTile&amp;format=</span><span class="sc">${</span>sourceOrtho<span class="op">.</span><span class="at">format</span><span class="sc">}</span><span class="vs">&amp;layer=</span><span class="sc">${</span>sourceOrtho<span class="op">.</span><span class="at">layer</span><span class="sc">}</span><span class="vs">&amp;tilematrixset=PM&amp;TileMatrix={z}&amp;TileCol={x}&amp;TileRow={y}`</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>      ]<span class="op">,</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tileSize</span><span class="op">:</span> <span class="dv">256</span><span class="op">,</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>      <span class="dt">attribution</span><span class="op">:</span> <span class="st">'© &lt;a href="https://www.ign.fr/"&gt;IGN&lt;/a&gt;'</span><span class="op">,</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>      <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>      <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">22</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addSource</span>(<span class="st">'raster-osm'</span><span class="op">,</span> {</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tiles</span><span class="op">:</span> [</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>    <span class="st">'https://tile.openstreetmap.org/{z}/{x}/{y}.png'</span></span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tileSize</span><span class="op">:</span> <span class="dv">256</span><span class="op">,</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>  <span class="dt">attribution</span><span class="op">:</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>    <span class="st">'© &lt;a href="https://www.openstreetmap.org/copyright"&gt;OpenStreetMap&lt;/a&gt; contributors'</span><span class="op">,</span></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>  <span class="dt">minzoom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxzoom</span><span class="op">:</span> <span class="dv">19</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> map<span class="op">.</span><span class="fu">addLayer</span>({ <span class="op">--&gt;</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">id</span><span class="op">:</span> <span class="st">'planIGN'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">source</span><span class="op">:</span> <span class="st">'raster-planign'</span><span class="op">,</span> <span class="op">--&gt;</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span>   <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'visible'</span> } <span class="op">--&gt;</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;!--</span> })<span class="op">;</span> <span class="op">--&gt;</span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span><span class="op">:</span> <span class="st">'orthoIGN'</span><span class="op">,</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> <span class="st">'raster-ortho'</span><span class="op">,</span></span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'none'</span> }</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>      <span class="dt">id</span><span class="op">:</span> <span class="st">'OSM'</span><span class="op">,</span></span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'raster'</span><span class="op">,</span></span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>      <span class="dt">source</span><span class="op">:</span> <span class="st">'raster-osm'</span><span class="op">,</span></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'visible'</span> } <span class="co">// tu peux le laisser caché au départ si tu veux le basculer ensuite</span></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> layersData <span class="op">=</span> [</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> bassin_vienne<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'bassinvienneLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'green'</span><span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>}}<span class="op">,</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> region<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'regionLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'red'</span><span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>} }<span class="op">,</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> departement<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'departementLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#a772b9'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span>  <span class="dt">layout</span><span class="op">:</span>{<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>}}<span class="op">,</span></span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> epci<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'epciLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#567ae3'</span><span class="op">,</span> <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>} }<span class="op">,</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>      {  <span class="dt">data</span><span class="op">:</span> indicateursGeojson<span class="op">,</span> <span class="co">// GeoJSON contenant une propriété 's31atx'</span></span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> <span class="st">'fill'</span><span class="op">,</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>          <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs25dLayer'</span><span class="op">,</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>          <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.9</span><span class="op">,</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>          <span class="dt">width</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>          <span class="dt">dynamicColor</span><span class="op">:</span> { </span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>            <span class="dt">property</span><span class="op">:</span> <span class="st">'s25d'</span><span class="op">,</span></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>            <span class="co">// La logique exacte de la légende à appliquer :</span></span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>            <span class="co">// - 0 ou null =&gt; #d9d9d9</span></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>            <span class="co">// - &lt; 150     =&gt; #f9f0d9</span></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>            <span class="co">// - &lt; 500000  =&gt; #fdb77a</span></span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>            <span class="co">// - &lt; 2000000 =&gt; #ec603F</span></span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>            <span class="co">// - &gt;= 2000000 =&gt; #b30000</span></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>            <span class="dt">mapping</span><span class="op">:</span> {</span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>              <span class="st">'0'</span><span class="op">:</span> <span class="st">'#d9d9d9'</span><span class="op">,</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>              <span class="st">'1'</span><span class="op">:</span> <span class="st">'#ffd700'</span><span class="op">,</span></span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>              <span class="st">'2'</span><span class="op">:</span> <span class="st">'#ff7600'</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>            <span class="cf">default</span><span class="op">:</span> <span class="st">'#d9d9d9'</span> <span class="co">// utilisé si null, undefined ou &lt; 150</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>          <span class="dt">layout</span><span class="op">:</span> { <span class="dt">visibility</span><span class="op">:</span> <span class="st">'visible'</span> }</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>        { <span class="dt">data</span><span class="op">:</span> cours_d_eau<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'coursdeauLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#b4c3ef'</span> <span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> </span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'visible'</span>} }<span class="op">,</span></span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> zone_inondable<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'fill'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'zoneinondableLayer'</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">'#b4c3ef'</span> <span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> </span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'visible'</span>} }<span class="op">,</span></span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">data</span><span class="op">:</span> batiments<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'fill-extrusion'</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">'batimentsLayer'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span><span class="dv">2</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">colorByType</span><span class="op">:</span> <span class="st">'ff_dteloctxt'</span><span class="op">,</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>        <span class="dt">heightProperty</span><span class="op">:</span> <span class="st">'hauteur'</span><span class="op">,</span><span class="dt">layout</span><span class="op">:</span> {<span class="dt">visibility</span><span class="op">:</span><span class="st">'none'</span>}}</span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Créer le conteneur</span></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> legend <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">id</span> <span class="op">=</span> <span class="st">'legend'</span><span class="op">;</span></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">top</span> <span class="op">=</span> <span class="st">'82%'</span><span class="op">;</span></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">right</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">transform</span> <span class="op">=</span> <span class="st">'translateY(-50%)'</span><span class="op">;</span></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">background</span> <span class="op">=</span> <span class="st">'white'</span><span class="op">;</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">padding</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">fontSize</span> <span class="op">=</span> <span class="st">'12px'</span><span class="op">;</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">borderRadius</span> <span class="op">=</span> <span class="st">'4px'</span><span class="op">;</span></span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">boxShadow</span> <span class="op">=</span> <span class="st">'0 1px 4px rgba(0,0,0,0.3)'</span><span class="op">;</span></span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1'</span><span class="op">;</span> <span class="co">// pour passer au-dessus de la carte</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Contenu de la légende</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>        legend<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;strong&gt;Nombre de stations &lt;br&gt; d’alimentation en eau &lt;br&gt; potable (AEP) en &lt;br&gt; zone inondable&lt;/strong&gt;&lt;br&gt;</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#d9d9d9;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; 0&lt;/div&gt;</span></span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ffd700;width:12px;height:12px;display:inline-block;margin-right:5px;border:1px solid #ccc;"&gt;&lt;/span&gt; 1-2 &lt;/div&gt;</span></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ff7600;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; 2-3 &lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>        <span class="co">// L’ajouter à la carte (le container MapLibre)</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(legend)<span class="op">;</span></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>        <span class="co">//afin de lier la légende à l'indicateur</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">updateLegendVisibility</span>() {</span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> visibility <span class="op">=</span> map<span class="op">.</span><span class="fu">getLayoutProperty</span>(<span class="st">'indicateurs25dLayer'</span><span class="op">,</span> <span class="st">'visibility'</span>)<span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (visibility <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>          legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>          legend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'block'</span><span class="op">;</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">on</span>(<span class="st">'idle'</span><span class="op">,</span> updateLegendVisibility)<span class="op">;</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Créer le conteneur de légende des bâtiments</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batimentLegend <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">id</span> <span class="op">=</span> <span class="st">'batiment-legend'</span><span class="op">;</span></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">top</span> <span class="op">=</span> <span class="st">'81%'</span><span class="op">;</span></span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">left</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">transform</span> <span class="op">=</span> <span class="st">'translateY(-50%)'</span><span class="op">;</span></span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">background</span> <span class="op">=</span> <span class="st">'white'</span><span class="op">;</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">padding</span> <span class="op">=</span> <span class="st">'10px'</span><span class="op">;</span></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">fontSize</span> <span class="op">=</span> <span class="st">'12px'</span><span class="op">;</span></span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">borderRadius</span> <span class="op">=</span> <span class="st">'4px'</span><span class="op">;</span></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">boxShadow</span> <span class="op">=</span> <span class="st">'0 1px 4px rgba(0,0,0,0.3)'</span><span class="op">;</span></span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1'</span><span class="op">;</span></span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Contenu de la légende</span></span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;strong&gt;Type de bâtiment&lt;/strong&gt;&lt;br&gt;</span></span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#1f77b4;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Activité&lt;/div&gt;</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#2ca02c;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Appartement&lt;/div&gt;</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#d9d9d9;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Aucun local&lt;/div&gt;</span></span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#9467bd;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Dépendance&lt;/div&gt;</span></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#ff7f0e;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Maison&lt;/div&gt;</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div&gt;&lt;span style="background:#e377c2;width:12px;height:12px;display:inline-block;margin-right:5px;"&gt;&lt;/span&gt; Mixte&lt;/div&gt;</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>        <span class="co">// L’ajouter à la carte</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(batimentLegend)<span class="op">;</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>        batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span> <span class="co">// Permet de supprimer l'affichage de la légende au chargement de la page</span></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Lier la visibilité à la couche bâtiment</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">updateBatimentLegendVisibility</span>() {</span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> visibility <span class="op">=</span> map<span class="op">.</span><span class="fu">getLayoutProperty</span>(<span class="st">'batimentsLayer'</span><span class="op">,</span> <span class="st">'visibility'</span>)<span class="op">;</span></span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>          <span class="co">//batimentLegend.style.display = (visibility === 'none') ? 'none' : 'block';</span></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (visibility <span class="op">===</span> <span class="st">'none'</span>) {</span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>          batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>          batimentLegend<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">'block'</span><span class="op">;</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">on</span>(<span class="st">'idle'</span><span class="op">,</span> updateBatimentLegendVisibility)<span class="op">;</span></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ajout des couches vectorielles</span></span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>      layersData<span class="op">.</span><span class="fu">forEach</span>(layer <span class="kw">=&gt;</span> {</span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addSource</span>(layer<span class="op">.</span><span class="at">id</span><span class="op">,</span> {</span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> <span class="st">'geojson'</span><span class="op">,</span></span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>          <span class="dt">data</span><span class="op">:</span> layer<span class="op">.</span><span class="at">data</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> layerConfig <span class="op">=</span> {</span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>          <span class="dt">id</span><span class="op">:</span> layer<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>          <span class="dt">type</span><span class="op">:</span> layer<span class="op">.</span><span class="at">type</span><span class="op">,</span></span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>          <span class="dt">source</span><span class="op">:</span> layer<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>          <span class="dt">paint</span><span class="op">:</span> {}<span class="op">,</span></span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>          <span class="dt">layout</span><span class="op">:</span> layer<span class="op">.</span><span class="at">layout</span></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (layer<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'fill'</span>) {</span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (layer<span class="op">.</span><span class="at">dynamicColor</span>) {</span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> prop <span class="op">=</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">;</span></span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-color'</span>] <span class="op">=</span> [</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>              <span class="st">'case'</span><span class="op">,</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'!'</span><span class="op">,</span> [<span class="st">'has'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]]<span class="op">,</span> <span class="st">'#d9d9d9'</span><span class="op">,</span>                       <span class="co">// Propriété absente</span></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'any'</span><span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="kw">null</span>]<span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span> <span class="st">'#d9d9d9'</span><span class="op">,</span> <span class="co">// null ou 0</span></span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'&lt;'</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span> <span class="st">'#ffd700'</span><span class="op">,</span></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'&gt;='</span><span class="op">,</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">dynamicColor</span><span class="op">.</span><span class="at">property</span>]<span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span> <span class="st">'#ff7600'</span><span class="op">,</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>              <span class="st">'#d9d9d9'</span> <span class="co">// fallback</span></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">;</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-color'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">color</span> <span class="op">||</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-opacity'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">opacity</span> <span class="op">||</span> <span class="fl">0.4</span><span class="op">;</span></span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-outline-color'</span>] <span class="op">=</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (layer<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'line'</span>) {</span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'line-color'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">color</span> <span class="op">||</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'line-width'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">width</span> <span class="op">||</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (layer<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'fill-extrusion'</span>) {</span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (layer<span class="op">.</span><span class="at">colorByType</span> <span class="op">===</span> <span class="st">'ff_dteloctxt'</span>) {</span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-color'</span>] <span class="op">=</span> [</span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>              <span class="st">'match'</span><span class="op">,</span></span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>              [<span class="st">'get'</span><span class="op">,</span> <span class="st">'ff_dteloctxt'</span>]<span class="op">,</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>              <span class="st">'ACTIVITE'</span><span class="op">,</span> <span class="st">'#1f77b4'</span><span class="op">,</span></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>              <span class="st">'APPARTEMENT'</span><span class="op">,</span> <span class="st">'#2ca02c'</span><span class="op">,</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>              <span class="st">'AUCUN LOCAL'</span><span class="op">,</span> <span class="st">'#d9d9d9'</span><span class="op">,</span></span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>              <span class="st">'DEPENDANCE'</span><span class="op">,</span> <span class="st">'#9467bd'</span><span class="op">,</span></span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>              <span class="st">'MAISON'</span><span class="op">,</span> <span class="st">'#ff7f0e'</span><span class="op">,</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>              <span class="st">'MIXTE'</span><span class="op">,</span> <span class="st">'#e377c2'</span><span class="op">,</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>              <span class="st">'#000000'</span> <span class="co">// fallback</span></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>            ]<span class="op">;</span></span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>          } <span class="cf">else</span> {</span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>            layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-color'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">color</span> <span class="op">||</span> <span class="st">'#000000'</span><span class="op">;</span></span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-height'</span>] <span class="op">=</span> [<span class="st">'get'</span><span class="op">,</span> layer<span class="op">.</span><span class="at">heightProperty</span> <span class="op">||</span> <span class="st">'hauteur'</span>]<span class="op">;</span></span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-base'</span>] <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>          layerConfig<span class="op">.</span><span class="at">paint</span>[<span class="st">'fill-extrusion-opacity'</span>] <span class="op">=</span> layer<span class="op">.</span><span class="at">opacity</span> <span class="op">||</span> <span class="fl">0.9</span><span class="op">;</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addLayer</span>(layerConfig)<span class="op">;</span></span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>         map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs25dLabels'</span><span class="op">,</span></span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">type</span><span class="op">:</span> <span class="st">'symbol'</span><span class="op">,</span></span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">source</span><span class="op">:</span> <span class="st">'indicateurs25dLayer'</span><span class="op">,</span> <span class="co">// le même id que ta source GeoJSON</span></span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">layout</span><span class="op">:</span> {</span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-field'</span><span class="op">:</span> [<span class="st">'get'</span><span class="op">,</span> <span class="st">'nom'</span>]<span class="op">,</span></span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-size'</span><span class="op">:</span> <span class="dv">11</span><span class="op">,</span></span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-font'</span><span class="op">:</span> [<span class="st">'Open Sans Bold'</span><span class="op">,</span> <span class="st">'Arial Unicode MS Bold'</span>]<span class="op">,</span></span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-offset'</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="fl">0.6</span>]<span class="op">,</span></span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-anchor'</span><span class="op">:</span> <span class="st">'top'</span></span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a>                  }<span class="op">,</span></span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">paint</span><span class="op">:</span> {</span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-color'</span><span class="op">:</span> <span class="st">'#000000'</span><span class="op">,</span></span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-halo-color'</span><span class="op">:</span> <span class="st">'#ffffff'</span><span class="op">,</span></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'text-halo-width'</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a>                  }</span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">addLayer</span>({</span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">id</span><span class="op">:</span> <span class="st">'indicateurs25d-hover'</span><span class="op">,</span></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">type</span><span class="op">:</span> <span class="st">'line'</span><span class="op">,</span></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">source</span><span class="op">:</span> <span class="st">'indicateurs25dLayer'</span><span class="op">,</span> <span class="co">// même source</span></span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">paint</span><span class="op">:</span> {</span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'line-color'</span><span class="op">:</span> <span class="st">'#000'</span><span class="op">,</span></span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'line-width'</span><span class="op">:</span> <span class="dv">2</span></span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>                  }<span class="op">,</span></span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>                 <span class="dt">filter</span><span class="op">:</span> [<span class="st">'=='</span><span class="op">,</span> <span class="st">'nom'</span><span class="op">,</span> <span class="st">''</span>] <span class="co">// vide au début</span></span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>                  })<span class="op">;</span></span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">on</span>(<span class="st">'click'</span><span class="op">,</span> <span class="st">'indicateurs25dLayer'</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> feature <span class="op">=</span> e<span class="op">.</span><span class="at">features</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> image<span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">image</span><span class="op">;</span></span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> nom <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nom</span> <span class="op">||</span> <span class="st">'Non disponible'</span><span class="op">;</span></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> population <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">population</span></span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">population</span><span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>) <span class="op">+</span> <span class="st">' habitants'</span></span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="st">'Non disponible'</span><span class="op">;</span></span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> s25dValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">s25d</span>)<span class="op">;</span></span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dommages <span class="op">=</span> (<span class="bu">Number</span>(s25dValue) <span class="op">||</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batimentsValue <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_batiments</span><span class="op">;</span></span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batiments <span class="op">=</span> <span class="op">!</span><span class="pp">isNaN</span>(<span class="pp">parseFloat</span>(batimentsValue))</span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="pp">parseInt</span>(batimentsValue)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="st">'Non disponible'</span><span class="op">;</span></span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batindif <span class="op">=</span> feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_indif</span><span class="op">?.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batsportifValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_sportif</span>)<span class="op">;</span></span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batsportif <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batsportifValue) <span class="op">?</span> batsportifValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batagricolefValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_agricole</span>)<span class="op">;</span></span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batagricole <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batagricolefValue) <span class="op">?</span> batagricolefValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batresidentielValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_residentiel</span>)<span class="op">;</span></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batresidentiel <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batresidentielValue) <span class="op">?</span> batresidentielValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batannexeValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_annexe</span>)<span class="op">;</span></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batannexe <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batannexeValue) <span class="op">?</span> batannexeValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batreligieuxValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_religieux</span>)<span class="op">;</span></span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batreligieux <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batreligieuxValue) <span class="op">?</span> batreligieuxValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batindustrielValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_industriel</span>)<span class="op">;</span></span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batindustriel <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batindustrielValue) <span class="op">?</span> batindustrielValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batcommercialValue <span class="op">=</span> <span class="pp">parseFloat</span>(feature<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nb_bat_commercial</span>)<span class="op">;</span></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> batcommercial <span class="op">=</span> (<span class="op">!</span><span class="pp">isNaN</span>(batcommercialValue) <span class="op">?</span> batcommercialValue <span class="op">:</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">'fr-FR'</span>)<span class="op">;</span></span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> popupContent <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;style&gt;</span></span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a><span class="vs">          .maplibregl-popup-content {</span></span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a><span class="vs">            padding: 4px !important;</span></span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a><span class="vs">            border: 1px solid;</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a><span class="vs">            border-radius: 8px;</span></span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a><span class="vs">            width: max-content;</span></span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a><span class="vs">            box-shadow: rgba(101, 147, 220, 0.2) 0px 4px 8px 0px;</span></span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a><span class="vs">            border-color: rgba(101, 147, 220, 0.5);</span></span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a><span class="vs">          }</span></span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;/style&gt;</span></span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div style="font-family: sans-serif; font-size: 13px; margin:10px;"&gt;</span></span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div style="background-color: #69774f; border: 1px solid; border-radius:8px; margin-bottom:16px; padding:10px; color:white;"&gt;&lt;strong&gt;</span></span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;center&gt;</span><span class="sc">${</span>nom<span class="sc">}</span><span class="vs">&lt;/center&gt;</span></span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/strong&gt;&lt;/div&gt;</span></span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;p style="margin:auto;"&gt;&lt;strong&gt;Population :&lt;/strong&gt; </span><span class="sc">${</span>population<span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;p style="margin:auto;"&gt;&lt;strong&gt;Nombre de stations d’alimentation &lt;br&gt; en eau potable (AEP) en zone inondable </span></span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a><span class="vs"> :&lt;/strong&gt; </span><span class="sc">${</span>dommages<span class="sc">}</span><span class="vs">&lt;/p&gt;</span></span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;</span></span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>        <span class="kw">new</span> maplibregl<span class="op">.</span><span class="fu">Popup</span>({<span class="dt">closeButton</span><span class="op">:</span> <span class="kw">false</span>})</span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">setLngLat</span>(e<span class="op">.</span><span class="at">lngLat</span>)</span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">setHTML</span>(popupContent)</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">addTo</span>(map)<span class="op">;</span></span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>          <span class="co">// Mettre à jour le conteneur HTML avec les informations spécifiques du marqueur </span></span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>         <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'donnees'</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;div style="text-align:center; font-family:sans-serif; font-size:16px;"&gt;</span></span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;div&gt;</span></span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;img src="</span><span class="sc">${</span>image<span class="sc">}</span><span class="vs">" style="width:300px; margin-bottom:10px;padding: 2px; background-color: darkgoldenrod;</span></span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a><span class="vs">                                margin-top: 13px;box-shadow: rgba(149, 31, 81, 0.77) 0px 4px 8px 0px;"&gt;</span></span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/div&gt;</span></span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;br&gt;</span></span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span></span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-geo-alt-fill"&gt;&lt;/i&gt; Commune :&lt;/strong&gt; </span><span class="sc">${</span>nom<span class="sc">}</span><span class="vs">&lt;br&gt;</span></span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-people-fill"&gt;&lt;/i&gt; Nombre d'habitants :&lt;/strong&gt; </span><span class="sc">${</span>population<span class="sc">}</span><span class="vs">&lt;br&gt;</span></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;strong style="font-size:1.1em;"&gt;&lt;i class="bi bi-house-fill"&gt;&lt;/i&gt; Nombre de bâtiments :&lt;/strong&gt; </span><span class="sc">${</span>batiments<span class="sc">}</span><span class="vs">&lt;br&gt;</span></span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a><span class="vs">            </span></span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;div style="margin-top:10px;"&gt;&lt;strong&gt;Dont :&lt;/strong&gt;&lt;/div&gt;</span></span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;ul style="list-style:none; padding:0;"&gt;</span></span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batindif<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments indifférenciés&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batsportif<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments sportifs&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batagricole<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments agricoles&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batresidentiel<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments résidentiels&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batannexe<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments annexes&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batreligieux<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments religieux&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batindustriel<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments industriels&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;li&gt;&lt;h5 style="font-size:1em;"&gt;</span><span class="sc">${</span>batcommercial<span class="sc">}</span><span class="vs"> &lt;strong&gt;bâtiments commerciaux&lt;/strong&gt;&lt;/h5&gt;&lt;/li&gt;</span></span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/ul&gt;</span></span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span></span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;div style="margin-top:10px;"&gt;</span></span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong style="font-size:1.1em;"&gt;&lt;i class="fas fa-tint"&gt;&lt;/i&gt; Nombre de stations d’alimentation en eau potable (AEP) en zone inondable  :&lt;/strong&gt; </span><span class="sc">${</span>dommages<span class="sc">}</span></span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;/div&gt;</span></span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;</span></span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a><span class="vs">        `</span><span class="op">;</span></span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">on</span>(<span class="st">'mousemove'</span><span class="op">,</span> <span class="st">'indicateurs25dLayer'</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (e<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> nomCommune <span class="op">=</span> e<span class="op">.</span><span class="at">features</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">nom</span><span class="op">;</span></span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">setFilter</span>(<span class="st">'indicateurs25d-hover'</span><span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> <span class="st">'nom'</span><span class="op">,</span> nomCommune])<span class="op">;</span></span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">getCanvas</span>()<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">'pointer'</span><span class="op">;</span></span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">on</span>(<span class="st">'mouseleave'</span><span class="op">,</span> <span class="st">'indicateurs25dLayer'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">setFilter</span>(<span class="st">'indicateurs25d-hover'</span><span class="op">,</span> [<span class="st">'=='</span><span class="op">,</span> <span class="st">'nom'</span><span class="op">,</span> <span class="st">''</span>])<span class="op">;</span></span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>          map<span class="op">.</span><span class="fu">getCanvas</span>()<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">''</span><span class="op">;</span></span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Interface de contrôle des couches</span></span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> mapLayersDiv <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">'mapLayers'</span>)<span class="op">;</span></span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1000'</span><span class="op">;</span></span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>    mapLayersDiv<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;button id="toggleMapMenuButton" class="btn btn-light aria-label="Afficher les couches" title="Afficher les couches"&gt;</span></span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;img src="Images/icons/layers-half.svg" alt="Icône SVG" width="25" height="25"&gt;</span></span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/button&gt;</span></span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div id="layersList" style="display: none; background: white; padding: 10px; border: 1px solid #ccc;"&gt;&lt;/div&gt;</span></span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(mapLayersDiv)<span class="op">;</span></span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> toggleableLayerIds <span class="op">=</span> layersData<span class="op">.</span><span class="fu">map</span>(layer <span class="kw">=&gt;</span> layer<span class="op">.</span><span class="at">id</span>)<span class="op">;</span></span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> aliasLayerIds <span class="op">=</span> {</span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bassinvienneLayer</span><span class="op">:</span> <span class="st">'Bassin de la Vienne'</span><span class="op">,</span></span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>      <span class="dt">regionLayer</span><span class="op">:</span> <span class="st">'Région'</span><span class="op">,</span></span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>      <span class="dt">departementLayer</span><span class="op">:</span> <span class="st">'Département'</span><span class="op">,</span></span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>      <span class="dt">epciLayer</span><span class="op">:</span> <span class="st">'Etablissement Public de Coopération Intercommunale'</span><span class="op">,</span></span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>      <span class="dt">coursdeauLayer</span><span class="op">:</span> <span class="st">"Cours d'eau"</span><span class="op">,</span></span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>      <span class="dt">zoneinondableLayer</span><span class="op">:</span> <span class="st">'Zonage Inondable'</span><span class="op">,</span></span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>      <span class="dt">indicateurs25dLayer</span><span class="op">:</span> <span class="st">"Nombre de stations d’alimentation en eau potable (AEP) en zone inondable"</span><span class="op">,</span></span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>      <span class="dt">batimentsLayer</span><span class="op">:</span> <span class="st">"Bâtiments"</span></span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">toggleLayerVisibility</span>(id<span class="op">,</span> visible) {</span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> visibility <span class="op">=</span> visible <span class="op">?</span> <span class="st">'visible'</span> <span class="op">:</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (map<span class="op">.</span><span class="fu">getLayer</span>(id)) {</span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>        map<span class="op">.</span><span class="fu">setLayoutProperty</span>(id<span class="op">,</span> <span class="st">'visibility'</span><span class="op">,</span> visibility)<span class="op">;</span></span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> layersListDiv <span class="op">=</span> mapLayersDiv<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'#layersList'</span>)<span class="op">;</span></span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a>    toggleableLayerIds<span class="op">.</span><span class="fu">forEach</span>(id <span class="kw">=&gt;</span> {</span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> name <span class="op">=</span> aliasLayerIds[id] <span class="op">||</span> id<span class="op">;</span></span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> checkbox <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'input'</span>)<span class="op">;</span></span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">type</span> <span class="op">=</span> <span class="st">'checkbox'</span><span class="op">;</span></span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">id</span> <span class="op">=</span> id<span class="op">;</span></span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'form-check-input'</span><span class="op">;</span></span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>      <span class="co">// ✅ Lire la visibilité actuelle directement dans la carte</span></span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>      map<span class="op">.</span><span class="fu">once</span>(<span class="st">'idle'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> visibility <span class="op">=</span> map<span class="op">.</span><span class="fu">getLayoutProperty</span>(id<span class="op">,</span> <span class="st">'visibility'</span>)<span class="op">;</span></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>        checkbox<span class="op">.</span><span class="at">checked</span> <span class="op">=</span> visibility <span class="op">===</span> <span class="st">'visible'</span><span class="op">;</span></span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'change'</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="fu">toggleLayerVisibility</span>(id<span class="op">,</span> checkbox<span class="op">.</span><span class="at">checked</span>))<span class="op">;</span></span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> label <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'label'</span>)<span class="op">;</span></span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">htmlFor</span> <span class="op">=</span> id<span class="op">;</span></span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'form-check-label'</span><span class="op">;</span></span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>      label<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> name<span class="op">;</span></span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> wrapper <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">'form-check'</span><span class="op">;</span></span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="fu">appendChild</span>(checkbox)<span class="op">;</span></span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="fu">appendChild</span>(label)<span class="op">;</span></span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>      layersListDiv<span class="op">.</span><span class="fu">appendChild</span>(wrapper)<span class="op">;</span></span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'toggleMapMenuButton'</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>      layersListDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> layersListDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">===</span> <span class="st">'none'</span> <span class="op">?</span> <span class="st">'block'</span> <span class="op">:</span> <span class="st">'none'</span><span class="op">;</span></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Menu bascule fond de plan</span></span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> mapMenuDiv <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'div'</span>)<span class="op">;</span></span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">'mapFondDePlan'</span>)<span class="op">;</span></span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">position</span> <span class="op">=</span> <span class="st">'absolute'</span><span class="op">;</span></span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">zIndex</span> <span class="op">=</span> <span class="st">'1000'</span><span class="op">;</span></span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>    mapMenuDiv<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;strong&gt;Fond de plan :&lt;/strong&gt;</span></span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;div class="form-check form-switch"&gt;</span></span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;input class="form-check-input" type="checkbox" role="switch" id="orthoCheckbox"&gt;</span></span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a><span class="vs">        &lt;label class="form-check-label" for="orthoCheckbox"&gt;Photos aériennes&lt;/label&gt;</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/div&gt;</span></span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="op">;</span></span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">getContainer</span>()<span class="op">.</span><span class="fu">appendChild</span>(mapMenuDiv)<span class="op">;</span></span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'orthoCheckbox'</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'change'</span><span class="op">,</span> <span class="kw">function</span> (e) {</span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a>      e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>      e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>      <span class="fu">toggleStyle</span>(<span class="kw">this</span><span class="op">.</span><span class="at">checked</span>)<span class="op">;</span></span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="card tabset html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-header bslib-navs-card-title"><div class="card-title html-fill-item html-fill-container"><span style="display: inline">

</span></div><ul class="nav nav-tabs card-header-tabs" role="tablist" data-tabsetid="card-tabset-2"><li class="nav-item" role="presentation"><a href="#card-tabset-2-1" role="tab" data-toggle="tab" data-bs-toggle="tab" data-value="Données de la commune" aria-selected="true" class="nav-link active">Données de la commune</a></li><li class="nav-item" role="presentation"><a href="#card-tabset-2-2" role="tab" data-toggle="tab" data-bs-toggle="tab" data-value="Tableau de données" aria-selected="false" class="nav-link">Tableau de données</a></li><li class="nav-item" role="presentation"><a href="#card-tabset-2-3" role="tab" data-toggle="tab" data-bs-toggle="tab" data-value="Graphiques" aria-selected="false" class="nav-link">Graphiques</a></li></ul></div>



<div class="tab-content html-fill-item html-fill-container" data-tabset-id="card-tabset-2"><div class="tab-pane active show html-fill-item html-fill-container" role="tabpanel" id="card-tabset-2-1"><div class="card-body html-fill-item html-fill-container" data-title="Données de la commune">
<div class="flow bslib-grid" data-layout="flow" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container" style="padding: 5px;">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb4" data-startfrom="632" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 631;"><span id="cb4-632"><a href="#cb4-632" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span></span>
<span id="cb4-633"><a href="#cb4-633" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div id="donnees" style="font-family: Arial, sans-serif; font-size: 16px; line-height: 1.5; margin-top:1%;"&gt;</span></span>
<span id="cb4-634"><a href="#cb4-634" aria-hidden="true" tabindex="-1"></a><span class="vs">    Cliquez sur une commune pour voir les informations ici.&lt;br&gt;</span></span>
<span id="cb4-635"><a href="#cb4-635" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb4-636"><a href="#cb4-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-637"><a href="#cb4-637" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-4" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div><div class="tab-pane html-fill-item html-fill-container" role="tabpanel" id="card-tabset-2-2"><div class="card-body html-fill-item html-fill-container" data-title="Tableau de données">
<div class="flow bslib-grid" data-layout="flow" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container">
<div class="cell-output-display html-fill-item html-fill-container">
<div class="reactable html-widget html-fill-item html-fill-container" id="htmlwidget-8fea778f321434df6c44" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8fea778f321434df6c44">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Code INSEE":["86095","86014","86088","86253","86062","86239","86114","86032","86298","86163","86124","86020","86261","86046","86091","86028","86213","86070","86233","86202","86058","86135","86226","86031","86024","86133","86194","86027","86158","86066","86041","86174","86139","86019","86115","86214","86116","86222","86244","86045","86256","86198","86157","86268","86080","86263","86297","86100","86083"],"Commune":["Dissay","Availles-en-Châtellerault","Croutelle","Sanxay","Chasseneuil-du-Poitou","Sainte-Radégonde","Jardres","Bonneuil-Matours","Vouneuil-sur-Vienne","Montamisé","Lavoux","Bellefonds","Sèvres-Anxaumont","Cenon-sur-Vienne","Curzay-sur-Vonne","Bignoux","Rouillé","Chauvigny","Valdivienne","La Puye","La Chapelle-Moulière","Liniers","Saint-Julien-l'Ars","Bonnes","Béruges","Ligugé","Poitiers","Biard","Migné-Auxances","Châtellerault","Buxerolles","Naintré","Lusignan","Beaumont Saint-Cyr","Jaunay-Marigny","Saint-Benoît","Jazeneuil","Saint-Georges-lès-Baillargeaux","Saint-Sauvant","Celle-Lévescault","Savigny-Lévescault","Pouillé","Mignaloux-Beauvoir","Tercé","Cloué","Smarves","Vouneuil-sous-Biard","Fontaine-le-Comte","Coulombiers"],"Population":[" 3 233"," 1 757","   851","   548"," 4 704","   169"," 1 273"," 2 104"," 2 198"," 3 630"," 1 180","   254"," 2 181"," 1 778","   410"," 1 054"," 2 468"," 7 049"," 2 747","   606","   705","   561"," 2 660"," 1 729"," 1 469"," 3 349","88 291"," 1 751"," 6 071","31 840","10 023"," 5 911"," 2 649"," 3 035"," 7 530"," 7 233","   804"," 4 168"," 1 258"," 1 356"," 1 168","   657"," 4 577"," 1 116","   496"," 2 810"," 5 896"," 3 853"," 1 164"],"Nombre de stations d’alimentation en eau potable (AEP) en zone inondable":[1,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,3,1,1,0,2,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"id":"Code INSEE","name":"Code INSEE","type":"character"},{"id":"Commune","name":"Commune","type":"character"},{"id":"Population","name":"Population","type":"character"},{"id":"Nombre de stations d’alimentation en eau potable (AEP) en zone inondable","name":"Nombre de stations d’alimentation en eau potable (AEP) en zone inondable","type":"numeric"}],"resizable":true,"filterable":true,"defaultPageSize":10,"highlight":true,"striped":true,"theme":{"borderColor":"#E0E0E0","stripedColor":"#f5f5f5","highlightColor":"#7591e5","cellPadding":"8px 12px","style":{"fontSize":"14px","fontFamily":"sans-serif"}},"dataKey":"700b16291aee4d27da5cade086fc9085"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div><div class="tab-pane html-fill-item html-fill-container" role="tabpanel" id="card-tabset-2-3"><div class="card-body html-fill-item html-fill-container" data-title="Graphiques">
<div class="flow bslib-grid" data-layout="flow" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container" style="padding: 5px;">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb5" data-startfrom="704" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 703;"><span id="cb5-704"><a href="#cb5-704" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Plot <span class="im">as</span> PlotTaux } <span class="im">from</span> <span class="st">"@observablehq/plot"</span><span class="op">;</span></span>
<span id="cb5-705"><a href="#cb5-705" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Inputs <span class="im">as</span> InputsTaux } <span class="im">from</span> <span class="st">"@observablehq/inputs"</span><span class="op">;</span></span>
<span id="cb5-706"><a href="#cb5-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-707"><a href="#cb5-707" aria-hidden="true" tabindex="-1"></a><span class="co">// Charger les données</span></span>
<span id="cb5-708"><a href="#cb5-708" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/data_s25d.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb5-709"><a href="#cb5-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-710"><a href="#cb5-710" aria-hidden="true" tabindex="-1"></a><span class="co">// Label du slider</span></span>
<span id="cb5-711"><a href="#cb5-711" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;label for="slider-s25d" style="display: block;</span></span>
<span id="cb5-712"><a href="#cb5-712" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-top: 1em;</span></span>
<span id="cb5-713"><a href="#cb5-713" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: bold;</span></span>
<span id="cb5-714"><a href="#cb5-714" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-bottom: 1em;</span></span>
<span id="cb5-715"><a href="#cb5-715" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid rgba(0, 0, 0, 0.6);</span></span>
<span id="cb5-716"><a href="#cb5-716" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.8);</span></span>
<span id="cb5-717"><a href="#cb5-717" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 8px;</span></span>
<span id="cb5-718"><a href="#cb5-718" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 5px;</span></span>
<span id="cb5-719"><a href="#cb5-719" aria-hidden="true" tabindex="-1"></a><span class="vs">  text-align: center;</span></span>
<span id="cb5-720"><a href="#cb5-720" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-right: 20%;</span></span>
<span id="cb5-721"><a href="#cb5-721" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-left: 20%;"&gt;</span></span>
<span id="cb5-722"><a href="#cb5-722" aria-hidden="true" tabindex="-1"></a><span class="vs">  Nombre de stations d’alimentation en eau potable (AEP) en zone inondable</span></span>
<span id="cb5-723"><a href="#cb5-723" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/label&gt;`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-4" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb6" data-startfrom="728" data-source-offset="-621"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 727;"><span id="cb6-728"><a href="#cb6-728" aria-hidden="true" tabindex="-1"></a>data_s25d <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/data_s25d.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb6-729"><a href="#cb6-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-730"><a href="#cb6-730" aria-hidden="true" tabindex="-1"></a>viewof slider_s25d <span class="op">=</span> InputsTaux<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> {</span>
<span id="cb6-731"><a href="#cb6-731" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb6-732"><a href="#cb6-732" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="co">//</span></span>
<span id="cb6-733"><a href="#cb6-733" aria-hidden="true" tabindex="-1"></a>  <span class="co">//label: "Linéaire d'itinéraires routiers interceptés en km"</span></span>
<span id="cb6-734"><a href="#cb6-734" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-735"><a href="#cb6-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-736"><a href="#cb6-736" aria-hidden="true" tabindex="-1"></a>sorted_s25d <span class="op">=</span> data_s25d</span>
<span id="cb6-737"><a href="#cb6-737" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({ <span class="op">...</span>d<span class="op">,</span> <span class="dt">s25d</span><span class="op">:</span> <span class="op">+</span>d<span class="op">.</span><span class="at">s25d</span> <span class="op">||</span> <span class="dv">0</span> }))</span>
<span id="cb6-738"><a href="#cb6-738" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">s25d</span> <span class="op">&lt;=</span> slider_s25d)</span>
<span id="cb6-739"><a href="#cb6-739" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a<span class="op">.</span><span class="at">s25d</span> <span class="op">-</span> b<span class="op">.</span><span class="at">s25d</span>)</span>
<span id="cb6-740"><a href="#cb6-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-741"><a href="#cb6-741" aria-hidden="true" tabindex="-1"></a>PlotTaux<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb6-742"><a href="#cb6-742" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb6-743"><a href="#cb6-743" aria-hidden="true" tabindex="-1"></a>    PlotTaux<span class="op">.</span><span class="fu">barY</span>(sorted_s25d<span class="op">,</span> {</span>
<span id="cb6-744"><a href="#cb6-744" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">nom</span><span class="op">,</span></span>
<span id="cb6-745"><a href="#cb6-745" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">s25d</span><span class="op">,</span></span>
<span id="cb6-746"><a href="#cb6-746" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> d <span class="kw">=&gt;</span> {</span>
<span id="cb6-747"><a href="#cb6-747" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> val <span class="op">=</span> d<span class="op">.</span><span class="at">s25d</span><span class="op">;</span></span>
<span id="cb6-748"><a href="#cb6-748" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">===</span> <span class="dv">0</span>) <span class="cf">return</span> <span class="st">"#d9d9d9"</span><span class="op">;</span></span>
<span id="cb6-749"><a href="#cb6-749" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">&lt;</span> <span class="dv">2</span>) <span class="cf">return</span> <span class="st">"#ffd700"</span><span class="op">;</span></span>
<span id="cb6-750"><a href="#cb6-750" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (val <span class="op">&gt;=</span> <span class="dv">2</span>) <span class="cf">return</span> <span class="st">"#ff7600"</span><span class="op">;</span></span>
<span id="cb6-751"><a href="#cb6-751" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"#67000d"</span><span class="op">;</span> <span class="co">// &gt;4</span></span>
<span id="cb6-752"><a href="#cb6-752" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-753"><a href="#cb6-753" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb6-754"><a href="#cb6-754" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb6-755"><a href="#cb6-755" aria-hidden="true" tabindex="-1"></a>    PlotTaux<span class="op">.</span><span class="fu">text</span>(sorted_s25d<span class="op">,</span> {</span>
<span id="cb6-756"><a href="#cb6-756" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">nom</span><span class="op">,</span></span>
<span id="cb6-757"><a href="#cb6-757" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">s25d</span><span class="op">,</span></span>
<span id="cb6-758"><a href="#cb6-758" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">s25d</span><span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr-FR"</span>)<span class="op">,</span></span>
<span id="cb6-759"><a href="#cb6-759" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">8</span><span class="op">,</span></span>
<span id="cb6-760"><a href="#cb6-760" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">9</span><span class="op">,</span></span>
<span id="cb6-761"><a href="#cb6-761" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb6-762"><a href="#cb6-762" aria-hidden="true" tabindex="-1"></a>      <span class="dt">textAnchor</span><span class="op">:</span> <span class="st">"middle"</span></span>
<span id="cb6-763"><a href="#cb6-763" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb6-764"><a href="#cb6-764" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb6-765"><a href="#cb6-765" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb6-766"><a href="#cb6-766" aria-hidden="true" tabindex="-1"></a>    <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb6-767"><a href="#cb6-767" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Nombre de stations d’alimentation en eau potable (AEP) en zone inondable"</span><span class="op">,</span></span>
<span id="cb6-768"><a href="#cb6-768" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>sorted_s25d<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">s25d</span>))]<span class="op">,</span></span>
<span id="cb6-769"><a href="#cb6-769" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tickFormat</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">toLocaleString</span>(<span class="st">"fr-FR"</span><span class="op">,</span> { <span class="dt">maximumFractionDigits</span><span class="op">:</span> <span class="dv">0</span> })</span>
<span id="cb6-770"><a href="#cb6-770" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb6-771"><a href="#cb6-771" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb6-772"><a href="#cb6-772" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Commune"</span><span class="op">,</span></span>
<span id="cb6-773"><a href="#cb6-773" aria-hidden="true" tabindex="-1"></a>    <span class="dt">tickRotate</span><span class="op">:</span> <span class="op">-</span><span class="dv">45</span><span class="op">,</span></span>
<span id="cb6-774"><a href="#cb6-774" aria-hidden="true" tabindex="-1"></a>    <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"right"</span></span>
<span id="cb6-775"><a href="#cb6-775" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb6-776"><a href="#cb6-776" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> {</span>
<span id="cb6-777"><a href="#cb6-777" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="st">"11px"</span><span class="op">,</span></span>
<span id="cb6-778"><a href="#cb6-778" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontFamily</span><span class="op">:</span> <span class="st">"sans-serif"</span><span class="op">,</span></span>
<span id="cb6-779"><a href="#cb6-779" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span></span>
<span id="cb6-780"><a href="#cb6-780" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb6-781"><a href="#cb6-781" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span> <span class="op">*</span> <span class="fl">0.95</span><span class="op">,</span></span>
<span id="cb6-782"><a href="#cb6-782" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerHeight</span> <span class="op">*</span> <span class="fl">0.65</span><span class="op">,</span></span>
<span id="cb6-783"><a href="#cb6-783" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">120</span><span class="op">,</span></span>
<span id="cb6-784"><a href="#cb6-784" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginTop</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb6-785"><a href="#cb6-785" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">80</span></span>
<span id="cb6-786"><a href="#cb6-786" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-8" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
</div></div></div><bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div id="informations-relatives-à-lindicateur" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-informations-relatives-à-lindicateur">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()">
<div class="card-body html-fill-item html-fill-container" style="padding: 5px;">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb7" data-startfrom="794" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 793;"><span id="cb7-794"><a href="#cb7-794" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span></span>
<span id="cb7-795"><a href="#cb7-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-796"><a href="#cb7-796" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;table style="width:90%; border-collapse: collapse; border:1px solid; text-align:center; margin:auto;"&gt;</span></span>
<span id="cb7-797"><a href="#cb7-797" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;colgroup&gt;</span></span>
<span id="cb7-798"><a href="#cb7-798" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-799"><a href="#cb7-799" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-800"><a href="#cb7-800" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-801"><a href="#cb7-801" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-802"><a href="#cb7-802" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-803"><a href="#cb7-803" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/colgroup&gt;</span></span>
<span id="cb7-804"><a href="#cb7-804" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-805"><a href="#cb7-805" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;" colspan="2"&gt;Numéro d'indicateur&lt;/th&gt;</span></span>
<span id="cb7-806"><a href="#cb7-806" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="border:1px solid;"&gt;Ind2/5d&lt;/th&gt;</span></span>
<span id="cb7-807"><a href="#cb7-807" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;"&gt;Date de mise à jour&lt;/th&gt;</span></span>
<span id="cb7-808"><a href="#cb7-808" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="border:1px solid;"&gt;31/05/2025&lt;/th&gt;</span></span>
<span id="cb7-809"><a href="#cb7-809" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-810"><a href="#cb7-810" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-811"><a href="#cb7-811" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Intitulé&lt;/td&gt;</span></span>
<span id="cb7-812"><a href="#cb7-812" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Nombre de stations d’alimentation en eau potable (AEP) en zone inondable&lt;/td&gt;</span></span>
<span id="cb7-813"><a href="#cb7-813" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-814"><a href="#cb7-814" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-815"><a href="#cb7-815" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Objectif de la SNGRI&lt;/td&gt;</span></span>
<span id="cb7-816"><a href="#cb7-816" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Objectif n°2 : Stabiliser à court terme et réduire à moyen terme le coût des dommages liés à l’inondation&lt;/td&gt;</span></span>
<span id="cb7-817"><a href="#cb7-817" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-818"><a href="#cb7-818" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-819"><a href="#cb7-819" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Axe de vulnérabilité&lt;/td&gt;</span></span>
<span id="cb7-820"><a href="#cb7-820" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Axe 2/2 Les dommages au patrimoine&lt;/td&gt;</span></span>
<span id="cb7-821"><a href="#cb7-821" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-822"><a href="#cb7-822" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-823"><a href="#cb7-823" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Source de vulnérabilité&lt;/td&gt;</span></span>
<span id="cb7-824"><a href="#cb7-824" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;S2/5 Dommages à l’environnement : charriage de pollutions et déchets&lt;/td&gt;</span></span>
<span id="cb7-825"><a href="#cb7-825" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-826"><a href="#cb7-826" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/table&gt;</span></span>
<span id="cb7-827"><a href="#cb7-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-828"><a href="#cb7-828" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;br&gt;</span></span>
<span id="cb7-829"><a href="#cb7-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-830"><a href="#cb7-830" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;table style="width:90%; border-collapse: collapse; border:1px solid; text-align:center; margin:auto;"&gt;</span></span>
<span id="cb7-831"><a href="#cb7-831" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;colgroup&gt;</span></span>
<span id="cb7-832"><a href="#cb7-832" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-833"><a href="#cb7-833" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-834"><a href="#cb7-834" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-835"><a href="#cb7-835" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-836"><a href="#cb7-836" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:20%;"&gt;</span></span>
<span id="cb7-837"><a href="#cb7-837" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/colgroup&gt;</span></span>
<span id="cb7-838"><a href="#cb7-838" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-839"><a href="#cb7-839" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Modalités du calcul&lt;/td&gt;</span></span>
<span id="cb7-840"><a href="#cb7-840" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;La couche des stations AEP est croisée avec la zone inondable (hauteur &gt; 0) et le résultat est agrégé à la commune.&lt;/td&gt;</span></span>
<span id="cb7-841"><a href="#cb7-841" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-842"><a href="#cb7-842" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-843"><a href="#cb7-843" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Échelle de représentation&lt;/td&gt;</span></span>
<span id="cb7-844"><a href="#cb7-844" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Communale&lt;/td&gt;</span></span>
<span id="cb7-845"><a href="#cb7-845" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-846"><a href="#cb7-846" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-847"><a href="#cb7-847" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Points de vigilance&lt;/td&gt;</span></span>
<span id="cb7-848"><a href="#cb7-848" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Pas de point de vigilance.&lt;/td&gt;</span></span>
<span id="cb7-849"><a href="#cb7-849" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-850"><a href="#cb7-850" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-851"><a href="#cb7-851" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Table cible&lt;/td&gt;</span></span>
<span id="cb7-852"><a href="#cb7-852" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;p_obj2_cout_dommages.s25d_capt_aep_zi&lt;/td&gt;</span></span>
<span id="cb7-853"><a href="#cb7-853" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-854"><a href="#cb7-854" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-855"><a href="#cb7-855" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-856"><a href="#cb7-856" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Variables mobilisées&lt;/td&gt;</span></span>
<span id="cb7-857"><a href="#cb7-857" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Zx : zone inondable, &lt;br&gt;Res1 : captages AEP&lt;/td&gt;</span></span>
<span id="cb7-858"><a href="#cb7-858" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-859"><a href="#cb7-859" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-860"><a href="#cb7-860" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-861"><a href="#cb7-861" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Indicateur commun SLGRI Vienne/Clain&lt;/td&gt;</span></span>
<span id="cb7-862"><a href="#cb7-862" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="3" style="border:1px solid;"&gt;Oui&lt;/td&gt;</span></span>
<span id="cb7-863"><a href="#cb7-863" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-864"><a href="#cb7-864" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-865"><a href="#cb7-865" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/table&gt;</span></span>
<span id="cb7-866"><a href="#cb7-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-867"><a href="#cb7-867" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;br&gt;</span></span>
<span id="cb7-868"><a href="#cb7-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-869"><a href="#cb7-869" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;table style="width:90%; border-collapse: collapse; border:1px solid; text-align:center; margin:auto;"&gt;</span></span>
<span id="cb7-870"><a href="#cb7-870" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;colgroup&gt;</span></span>
<span id="cb7-871"><a href="#cb7-871" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-872"><a href="#cb7-872" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-873"><a href="#cb7-873" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-874"><a href="#cb7-874" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-875"><a href="#cb7-875" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-876"><a href="#cb7-876" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-877"><a href="#cb7-877" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-878"><a href="#cb7-878" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-879"><a href="#cb7-879" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-880"><a href="#cb7-880" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;col style="width:10%;"&gt;</span></span>
<span id="cb7-881"><a href="#cb7-881" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/colgroup&gt;</span></span>
<span id="cb7-882"><a href="#cb7-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-883"><a href="#cb7-883" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-884"><a href="#cb7-884" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="10" style="background-color:#BEDBE8; border:1px solid; font-weight: bold;"&gt;Données sources&lt;/td&gt;</span></span>
<span id="cb7-885"><a href="#cb7-885" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-886"><a href="#cb7-886" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-887"><a href="#cb7-887" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;" colspan="2"&gt;Désignation&lt;/th&gt;</span></span>
<span id="cb7-888"><a href="#cb7-888" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;"&gt;Millésime&lt;/th&gt;</span></span>
<span id="cb7-889"><a href="#cb7-889" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;"&gt;Nationale/locale&lt;/th&gt;</span></span>
<span id="cb7-890"><a href="#cb7-890" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;"&gt;Format&lt;/th&gt;</span></span>
<span id="cb7-891"><a href="#cb7-891" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;"&gt;Type&lt;/th&gt;</span></span>
<span id="cb7-892"><a href="#cb7-892" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;" colspan="2"&gt;Producteur&lt;/th&gt;</span></span>
<span id="cb7-893"><a href="#cb7-893" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;th style="background-color:#BEDBE8; border:1px solid;" colspan="2"&gt;Nom fichier&lt;/th&gt;</span></span>
<span id="cb7-894"><a href="#cb7-894" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-895"><a href="#cb7-895" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-896"><a href="#cb7-896" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Zone inondable&lt;/td&gt;</span></span>
<span id="cb7-897"><a href="#cb7-897" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2019&lt;/td&gt;</span></span>
<span id="cb7-898"><a href="#cb7-898" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Locale&lt;/td&gt;</span></span>
<span id="cb7-899"><a href="#cb7-899" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb7-900"><a href="#cb7-900" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Polygone&lt;/td&gt;</span></span>
<span id="cb7-901"><a href="#cb7-901" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Cerema&lt;/td&gt;</span></span>
<span id="cb7-902"><a href="#cb7-902" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Zx_zone_inondable.shp&lt;/td&gt;</span></span>
<span id="cb7-903"><a href="#cb7-903" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-904"><a href="#cb7-904" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-905"><a href="#cb7-905" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Captages AEP&lt;/td&gt;</span></span>
<span id="cb7-906"><a href="#cb7-906" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2020&lt;/td&gt;</span></span>
<span id="cb7-907"><a href="#cb7-907" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Locale&lt;/td&gt;</span></span>
<span id="cb7-908"><a href="#cb7-908" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb7-909"><a href="#cb7-909" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Point&lt;/td&gt;</span></span>
<span id="cb7-910"><a href="#cb7-910" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;ARS NA&lt;/td&gt;</span></span>
<span id="cb7-911"><a href="#cb7-911" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;captage_aep.shp&lt;/td&gt;</span></span>
<span id="cb7-912"><a href="#cb7-912" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-913"><a href="#cb7-913" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;tr&gt;</span></span>
<span id="cb7-914"><a href="#cb7-914" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Communes (BDTOPO)&lt;/td&gt;</span></span>
<span id="cb7-915"><a href="#cb7-915" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;2020&lt;/td&gt;</span></span>
<span id="cb7-916"><a href="#cb7-916" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Nationale&lt;/td&gt;</span></span>
<span id="cb7-917"><a href="#cb7-917" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Shape&lt;/td&gt;</span></span>
<span id="cb7-918"><a href="#cb7-918" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td style="border:1px solid;"&gt;Polygone&lt;/td&gt;</span></span>
<span id="cb7-919"><a href="#cb7-919" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;IGN&lt;/td&gt;</span></span>
<span id="cb7-920"><a href="#cb7-920" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;td colspan="2" style="border:1px solid;"&gt;Commune.shp&lt;/td&gt;</span></span>
<span id="cb7-921"><a href="#cb7-921" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/tr&gt;</span></span>
<span id="cb7-922"><a href="#cb7-922" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/table&gt;</span></span>
<span id="cb7-923"><a href="#cb7-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-924"><a href="#cb7-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-925"><a href="#cb7-925" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div><div id="bâtiments-en-3d-mode-demploi" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="columns" aria-labelledby="tab-bâtiments-en-3d-mode-demploi">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="card html-fill-item html-fill-container bslib-card" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<p><i class="bi bi-box"></i> <strong>Incliner et faire tourner la carte</strong><br>
Maintenez enfoncé le bouton droit de la souris sur ce symbole <img src="Images/bouton_inclinaison.jpg" style="margin-bottom:auto; width:2%;"> et déplacez le pour incliner le point de vue ou faire tourner la carte.</p>
<p><i class="bi bi-mouse2"></i> <strong>Zoomer sur la carte</strong><br>
Zoomer sur la carte (molette de la souris) pour visualiser les bâtiments.</p>
<p><i class="bi bi-info-circle"></i> <strong>Une illustration pour bien comprendre la carte interactive</strong></p>
<div class="quarto-figure quarto-figure-left html-fill-item html-fill-container">
<figure class="figure">
<p><img src="Images/batiments_3d.jpg" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>Bâtiments 3D</figcaption>
</figure>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div><div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div></div><aside id="bslib-sidebar-1" class="sidebar html-fill-container html-fill-item"><div class="html-fill-container html-fill-item">
<div id="nav-menu-objectif-n°2"></div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="34" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 33;"><span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>bbox_sru <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"layers/bb.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div style="color:#dc7633; text-align:inherit !important; font-size:1.3em; font-weight:bold; font-family: calibri;margin-bottom:10%;">
Nombre de stations d’alimentation en eau potable (AEP) en zone inondable 
 </div>

<div style="text-align:inherit !important; font-size:1.1em; font-family: calibri;margin-bottom:10%;">La présence de captages d’eau potable peut potentiellement poser un problème si des pollutions sont entraînées par l’inondation, ou s’ils sont colmatés par des atterrissements.</div>


<a href="https://fiches.eptb-vienne.fr/ind_25d.pdf" target="_blank"><i class="fa fa-exclamation-circle"></i> Télécharger la fiche indicateur et la carte</a> 


<div style="width: auto; padding:5px; border: 1px solid #A0A0A0; border-radius:15px; text-align: center !important; background: #F2F2F2; font-size:1.1em;margin-top:10%;">
La zone inondable correspond à l'aléa centennal construit à partir des données disponibles et notamment réglementaires mais en aucun cas ne se substitue aux documents réglementaires en vigueur.
</div>
</div></aside>
<button class="collapse-toggle" type="button" title="Toggle sidebar" aria-expanded="true" aria-controls="bslib-sidebar-1">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 16 16" class="bi bi-chevron-left collapse-icon" style="fill:currentColor;" aria-hidden="true" role="img">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path>
    </svg>
</button>
<script data-bslib-sidebar-init="">
bslib.Sidebar.initCollapsibleAll()
</script>
</div>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJib3hfc3J1ID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvYmIuanNvblwiKS5qc29uKClcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuYmFzc2luX3ZpZW5uZSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2Jhc3Npbl92aWVubmUuZ2VvanNvblwiKS5qc29uKCk7XG5kZXBhcnRlbWVudCA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2RlcGFydGVtZW50Lmdlb2pzb25cIikuanNvbigpO1xucmVnaW9uID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvcmVnaW9uLmdlb2pzb25cIikuanNvbigpO1xuZXBjaSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2VwY2kuZ2VvanNvblwiKS5qc29uKCk7XG5wZXJpbWV0cmUgPSBGaWxlQXR0YWNobWVudChcImxheWVycy9wZXJpbWV0cmUuanNvblwiKS5qc29uKCk7XG5zbGdyaSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL3NsZ3JpLmpzb25cIikuanNvbigpO1xudHJpID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvdHJpLmpzb25cIikuanNvbigpO1xuem9uZV9pbm9uZGFibGUgPSBGaWxlQXR0YWNobWVudChcImxheWVycy96b25lX2lub25kYWJsZS5nZW9qc29uXCIpLmpzb24oKTtcbi8vaW5kaWNhdGV1cnMgPSBGaWxlQXR0YWNobWVudChcImxheWVycy9pbmRpY2F0ZXVycy5qc29uXCIpLmpzb24oKTtcbmNvdXJzX2RfZWF1ID0gRmlsZUF0dGFjaG1lbnQoXCJsYXllcnMvY291cnNfZF9lYXUuZ2VvanNvblwiKS5qc29uKCk7XG5pbmRpY2F0ZXVyc0dlb2pzb24gPSBGaWxlQXR0YWNobWVudChcImxheWVycy9pbmRpY2F0ZXVycy5nZW9qc29uXCIpLmpzb24oKTtcbmJhdGltZW50cyA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2JhdGltZW50c19oYXV0ZXVyLmdlb2pzb25cIikuanNvbigpO1xuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcblxubWFwID0ge1xuICBjb25zdCBjb250YWluZXIgPSBodG1sYDxkaXYgY2xhc3M9XCJtYXAtY29udGFpbmVyXCIgaWQ9XCJtYXBcIiBzdHlsZT1cImhlaWdodDogNjY1cHg7IHdpZHRoOiAxMDAlO1wiPjwvZGl2PmA7XG4gIHlpZWxkIGNvbnRhaW5lcjtcblxuICA8IS0tIGNvbnN0IHNvdXJjZVBsYW5JR04gPSB7IC0tPlxuICA8IS0tICAgc3R5bGU6ICdub3JtYWwnLCAtLT5cbiAgPCEtLSAgIGZvcm1hdDogJ2ltYWdlL3BuZycsIC0tPlxuICA8IS0tICAgbGF5ZXI6ICdHRU9HUkFQSElDQUxHUklEU1lTVEVNUy5QTEFOSUdOVjInIC0tPlxuICA8IS0tIH07IC0tPlxuXG4gIGNvbnN0IHNvdXJjZU9ydGhvID0ge1xuICAgIHN0eWxlOiAnbm9ybWFsJyxcbiAgICBmb3JtYXQ6ICdpbWFnZS9qcGVnJyxcbiAgICBsYXllcjogJ0hSLk9SVEhPSU1BR0VSWS5PUlRIT1BIT1RPUydcbiAgfTtcbiAgXG4gIGNvbnN0IHNvdXJjZU9TTSA9IHtcbiAgICB0aWxlczogJ2h0dHBzOi8vdGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLFxuICAgIGF0dHJpYnV0aW9uOiAnwqkgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL2NvcHlyaWdodFwiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycycsXG4gICAgbWluem9vbTogMCxcbiAgICBtYXh6b29tOiAxOVxuICB9O1xuXG4gIGNvbnN0IG1hcCA9IG5ldyBtYXBsaWJyZWdsLk1hcCh7XG4gICAgY29udGFpbmVyOiBjb250YWluZXIsXG4gICAgc3R5bGU6ICdodHRwczovL2Jhc2VtYXBzLmNhcnRvY2RuLmNvbS9nbC92b3lhZ2VyLWdsLXN0eWxlL3N0eWxlLmpzb24nLFxuICAgIDwhLS0gY2VudGVyOiBbLTAuMDQsIDQ2LjMwNTFdLCAgLS0+XG4gICAgem9vbTogMTFcbiAgfSk7XG5cbiAgbWFwLmFkZENvbnRyb2wobmV3IG1hcGxpYnJlZ2wuRnVsbHNjcmVlbkNvbnRyb2woKSwgJ3RvcC1yaWdodCcpO1xuICBtYXAuYWRkQ29udHJvbChuZXcgbWFwbGlicmVnbC5OYXZpZ2F0aW9uQ29udHJvbCh7IHZpc3VhbGl6ZVBpdGNoOiB0cnVlIH0pLCAndG9wLWxlZnQnKTtcbiAgbWFwLmFkZENvbnRyb2wobmV3IG1hcGxpYnJlZ2wuU2NhbGVDb250cm9sKHsgbWF4V2lkdGg6IDgwLCB1bml0OiAnbWV0cmljJyB9KSk7XG4gIFxuXG4gIGNvbnN0IHRvZ2dsZVN0eWxlID0gKHVzZU9ydGhvKSA9PiB7XG4gICAgaWYgKHVzZU9ydGhvKSB7XG4gICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoJ29ydGhvSUdOJywgJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KCdPU00nLCAndmlzaWJpbGl0eScsICdub25lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnb3J0aG9JR04nLCAndmlzaWJpbGl0eScsICdub25lJyk7XG4gICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoJ09TTScsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgICB9XG4gIH07XG5cbiAgbWFwLm9uKCdsb2FkJywgKCkgPT4ge1xuICAgIG1hcC5maXRCb3VuZHMoXG4gICAgW1xuICAgICAgWy0wLjA0LCA0Ni4zMDUxXSwgICAvLyBTdWQtT3Vlc3RcbiAgICAgIFswLjc3NDEsIDQ2Ljg1NjVdICAgLy8gTm9yZC1Fc3RcbiAgICBdLFxuICAgIHtcbiAgICAgIHBhZGRpbmc6IDIwLFxuICAgICAgbGluZWFyOiB0cnVlLFxuICAgICAgZHVyYXRpb246IDBcbiAgICB9XG4gICk7XG4gICAgLy8gQWpvdXQgZGVzIGZvbmRzIHJhc3RlciBJR05cbiAgICA8IS0tIG1hcC5hZGRTb3VyY2UoJ3Jhc3Rlci1wbGFuaWduJywgeyAtLT5cbiAgICA8IS0tICAgdHlwZTogJ3Jhc3RlcicsIC0tPlxuICAgIDwhLS0gICB0aWxlczogWyAtLT5cbiAgICA8IS0tICAgICBgaHR0cHM6Ly9kYXRhLmdlb3BmLmZyL3dtdHM/U0VSVklDRT1XTVRTJnN0eWxlPSR7c291cmNlUGxhbklHTi5zdHlsZX0mVkVSU0lPTj0xLjAuMCZSRVFVRVNUPUdldFRpbGUmZm9ybWF0PSR7c291cmNlUGxhbklHTi5mb3JtYXR9JmxheWVyPSR7c291cmNlUGxhbklHTi5sYXllcn0mdGlsZW1hdHJpeHNldD1QTSZUaWxlTWF0cml4PXt6fSZUaWxlQ29sPXt4fSZUaWxlUm93PXt5fWAgLS0+XG4gICAgPCEtLSAgIF0sIC0tPlxuICAgIDwhLS0gICB0aWxlU2l6ZTogMjU2LCAtLT5cbiAgICA8IS0tICAgYXR0cmlidXRpb246ICfCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cuaWduLmZyL1wiPklHTjwvYT4nLCAtLT5cbiAgICA8IS0tICAgbWluem9vbTogMCwgLS0+XG4gICAgPCEtLSAgIG1heHpvb206IDIyIC0tPlxuICAgIDwhLS0gfSk7IC0tPlxuXG4gICAgbWFwLmFkZFNvdXJjZSgncmFzdGVyLW9ydGhvJywge1xuICAgICAgdHlwZTogJ3Jhc3RlcicsXG4gICAgICB0aWxlczogW1xuICAgICAgICBgaHR0cHM6Ly9kYXRhLmdlb3BmLmZyL3dtdHM/U0VSVklDRT1XTVRTJnN0eWxlPSR7c291cmNlT3J0aG8uc3R5bGV9JlZFUlNJT049MS4wLjAmUkVRVUVTVD1HZXRUaWxlJmZvcm1hdD0ke3NvdXJjZU9ydGhvLmZvcm1hdH0mbGF5ZXI9JHtzb3VyY2VPcnRoby5sYXllcn0mdGlsZW1hdHJpeHNldD1QTSZUaWxlTWF0cml4PXt6fSZUaWxlQ29sPXt4fSZUaWxlUm93PXt5fWBcbiAgICAgIF0sXG4gICAgICB0aWxlU2l6ZTogMjU2LFxuICAgICAgYXR0cmlidXRpb246ICfCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cuaWduLmZyL1wiPklHTjwvYT4nLFxuICAgICAgbWluem9vbTogMCxcbiAgICAgIG1heHpvb206IDIyXG4gICAgfSk7XG5cbiAgICBtYXAuYWRkU291cmNlKCdyYXN0ZXItb3NtJywge1xuICB0eXBlOiAncmFzdGVyJyxcbiAgdGlsZXM6IFtcbiAgICAnaHR0cHM6Ly90aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZydcbiAgXSxcbiAgdGlsZVNpemU6IDI1NixcbiAgYXR0cmlidXRpb246XG4gICAgJ8KpIDxhIGhyZWY9XCJodHRwczovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9jb3B5cmlnaHRcIj5PcGVuU3RyZWV0TWFwPC9hPiBjb250cmlidXRvcnMnLFxuICBtaW56b29tOiAwLFxuICBtYXh6b29tOiAxOVxuICAgIH0pO1xuXG4gICAgPCEtLSBtYXAuYWRkTGF5ZXIoeyAtLT5cbiAgICA8IS0tICAgaWQ6ICdwbGFuSUdOJywgLS0+XG4gICAgPCEtLSAgIHR5cGU6ICdyYXN0ZXInLCAtLT5cbiAgICA8IS0tICAgc291cmNlOiAncmFzdGVyLXBsYW5pZ24nLCAtLT5cbiAgICA8IS0tICAgbGF5b3V0OiB7IHZpc2liaWxpdHk6ICd2aXNpYmxlJyB9IC0tPlxuICAgIDwhLS0gfSk7IC0tPlxuXG4gICAgbWFwLmFkZExheWVyKHtcbiAgICAgIGlkOiAnb3J0aG9JR04nLFxuICAgICAgdHlwZTogJ3Jhc3RlcicsXG4gICAgICBzb3VyY2U6ICdyYXN0ZXItb3J0aG8nLFxuICAgICAgbGF5b3V0OiB7IHZpc2liaWxpdHk6ICdub25lJyB9XG4gICAgfSk7XG5cbiAgICBtYXAuYWRkTGF5ZXIoe1xuICAgICAgaWQ6ICdPU00nLFxuICAgICAgdHlwZTogJ3Jhc3RlcicsXG4gICAgICBzb3VyY2U6ICdyYXN0ZXItb3NtJyxcbiAgICAgIGxheW91dDogeyB2aXNpYmlsaXR5OiAndmlzaWJsZScgfSAvLyB0dSBwZXV4IGxlIGxhaXNzZXIgY2FjaMOpIGF1IGTDqXBhcnQgc2kgdHUgdmV1eCBsZSBiYXNjdWxlciBlbnN1aXRlXG4gICAgfSk7XG4gICAgICAgICAgICAgIFxuICAgIFxuICAgIGNvbnN0IGxheWVyc0RhdGEgPSBbXG4gICAgICB7IGRhdGE6IGJhc3Npbl92aWVubmUsIHR5cGU6ICdsaW5lJywgaWQ6ICdiYXNzaW52aWVubmVMYXllcicsIGNvbG9yOiAnZ3JlZW4nLCBsYXlvdXQ6IHt2aXNpYmlsaXR5Oidub25lJ319LFxuICAgICAgeyBkYXRhOiByZWdpb24sIHR5cGU6ICdsaW5lJywgaWQ6ICdyZWdpb25MYXllcicsIGNvbG9yOiAncmVkJywgbGF5b3V0OiB7dmlzaWJpbGl0eTonbm9uZSd9IH0sXG4gICAgICB7IGRhdGE6IGRlcGFydGVtZW50LCB0eXBlOiAnbGluZScsIGlkOiAnZGVwYXJ0ZW1lbnRMYXllcicsIGNvbG9yOiAnI2E3NzJiOScsIHdpZHRoOiAyLCAgbGF5b3V0Ont2aXNpYmlsaXR5Oidub25lJ319LFxuICAgICAgeyBkYXRhOiBlcGNpLCB0eXBlOiAnbGluZScsIGlkOiAnZXBjaUxheWVyJywgY29sb3I6ICcjNTY3YWUzJywgbGF5b3V0OiB7dmlzaWJpbGl0eTonbm9uZSd9IH0sXG4gICAgICB7ICBkYXRhOiBpbmRpY2F0ZXVyc0dlb2pzb24sIC8vIEdlb0pTT04gY29udGVuYW50IHVuZSBwcm9wcmnDqXTDqSAnczMxYXR4J1xuICAgICAgICAgIHR5cGU6ICdmaWxsJyxcbiAgICAgICAgICBpZDogJ2luZGljYXRldXJzMjVkTGF5ZXInLFxuICAgICAgICAgIG9wYWNpdHk6IDAuOSxcbiAgICAgICAgICB3aWR0aDogMSxcbiAgICAgICAgICBkeW5hbWljQ29sb3I6IHsgXG4gICAgICAgICAgICBwcm9wZXJ0eTogJ3MyNWQnLFxuICAgICAgICAgICAgLy8gTGEgbG9naXF1ZSBleGFjdGUgZGUgbGEgbMOpZ2VuZGUgw6AgYXBwbGlxdWVyIDpcbiAgICAgICAgICAgIC8vIC0gMCBvdSBudWxsID0+ICNkOWQ5ZDlcbiAgICAgICAgICAgIC8vIC0gPCAxNTAgICAgID0+ICNmOWYwZDlcbiAgICAgICAgICAgIC8vIC0gPCA1MDAwMDAgID0+ICNmZGI3N2FcbiAgICAgICAgICAgIC8vIC0gPCAyMDAwMDAwID0+ICNlYzYwM0ZcbiAgICAgICAgICAgIC8vIC0gPj0gMjAwMDAwMCA9PiAjYjMwMDAwXG4gICAgICAgICAgICBtYXBwaW5nOiB7XG4gICAgICAgICAgICAgICcwJzogJyNkOWQ5ZDknLFxuICAgICAgICAgICAgICAnMSc6ICcjZmZkNzAwJyxcbiAgICAgICAgICAgICAgJzInOiAnI2ZmNzYwMCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWZhdWx0OiAnI2Q5ZDlkOScgLy8gdXRpbGlzw6kgc2kgbnVsbCwgdW5kZWZpbmVkIG91IDwgMTUwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBsYXlvdXQ6IHsgdmlzaWJpbGl0eTogJ3Zpc2libGUnIH1cbiAgICAgICAgfSxcbiAgICAgICAgeyBkYXRhOiBjb3Vyc19kX2VhdSwgdHlwZTogJ2xpbmUnLCBpZDogJ2NvdXJzZGVhdUxheWVyJywgY29sb3I6ICcjYjRjM2VmJyAsIHdpZHRoOiAyLCBvcGFjaXR5OiAxLCBcbiAgICAgIGxheW91dDoge3Zpc2liaWxpdHk6J3Zpc2libGUnfSB9LFxuICAgICAgeyBkYXRhOiB6b25lX2lub25kYWJsZSwgdHlwZTogJ2ZpbGwnLCBpZDogJ3pvbmVpbm9uZGFibGVMYXllcicsIGNvbG9yOiAnI2I0YzNlZicgLCB3aWR0aDogMiwgb3BhY2l0eTogMSwgXG4gICAgICBsYXlvdXQ6IHt2aXNpYmlsaXR5Oid2aXNpYmxlJ30gfSxcbiAgICAgIHsgZGF0YTogYmF0aW1lbnRzLCB0eXBlOiAnZmlsbC1leHRydXNpb24nLCBpZDogJ2JhdGltZW50c0xheWVyJywgd2lkdGg6Miwgb3BhY2l0eTogMSwgY29sb3JCeVR5cGU6ICdmZl9kdGVsb2N0eHQnLFxuICAgICAgICBoZWlnaHRQcm9wZXJ0eTogJ2hhdXRldXInLGxheW91dDoge3Zpc2liaWxpdHk6J25vbmUnfX1cbiAgICAgIFxuICAgIF07XG4gICAgXG4gICAgLy8gQ3LDqWVyIGxlIGNvbnRlbmV1clxuICAgICAgICBjb25zdCBsZWdlbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgbGVnZW5kLmlkID0gJ2xlZ2VuZCc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS50b3AgPSAnODIlJztcbiAgICAgICAgbGVnZW5kLnN0eWxlLnJpZ2h0ID0gJzEwcHgnO1xuICAgICAgICBsZWdlbmQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoLTUwJSknO1xuICAgICAgICBsZWdlbmQuc3R5bGUuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS5wYWRkaW5nID0gJzEwcHgnO1xuICAgICAgICBsZWdlbmQuc3R5bGUuZm9udFNpemUgPSAnMTJweCc7XG4gICAgICAgIGxlZ2VuZC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgbGVnZW5kLnN0eWxlLmJveFNoYWRvdyA9ICcwIDFweCA0cHggcmdiYSgwLDAsMCwwLjMpJztcbiAgICAgICAgbGVnZW5kLnN0eWxlLnpJbmRleCA9ICcxJzsgLy8gcG91ciBwYXNzZXIgYXUtZGVzc3VzIGRlIGxhIGNhcnRlXG4gICAgICAgIFxuICAgICAgICAvLyBDb250ZW51IGRlIGxhIGzDqWdlbmRlXG4gICAgICAgIGxlZ2VuZC5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgPHN0cm9uZz5Ob21icmUgZGUgc3RhdGlvbnMgPGJyPiBk4oCZYWxpbWVudGF0aW9uIGVuIGVhdSA8YnI+IHBvdGFibGUgKEFFUCkgZW4gPGJyPiB6b25lIGlub25kYWJsZTwvc3Ryb25nPjxicj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojZDlkOWQ5O3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtcIj48L3NwYW4+IDA8L2Rpdj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojZmZkNzAwO3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtib3JkZXI6MXB4IHNvbGlkICNjY2M7XCI+PC9zcGFuPiAxLTIgPC9kaXY+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6I2ZmNzYwMDt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7XCI+PC9zcGFuPiAyLTMgPC9kaXY+YDtcbiAgICAgICAgXG4gICAgICAgIC8vIEzigJlham91dGVyIMOgIGxhIGNhcnRlIChsZSBjb250YWluZXIgTWFwTGlicmUpXG4gICAgICAgIG1hcC5nZXRDb250YWluZXIoKS5hcHBlbmRDaGlsZChsZWdlbmQpO1xuICAgICAgICBcbiAgICAgICAgLy9hZmluIGRlIGxpZXIgbGEgbMOpZ2VuZGUgw6AgbCdpbmRpY2F0ZXVyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUxlZ2VuZFZpc2liaWxpdHkoKSB7XG4gICAgICAgIGNvbnN0IHZpc2liaWxpdHkgPSBtYXAuZ2V0TGF5b3V0UHJvcGVydHkoJ2luZGljYXRldXJzMjVkTGF5ZXInLCAndmlzaWJpbGl0eScpO1xuICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gJ25vbmUnKSB7XG4gICAgICAgICAgbGVnZW5kLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGVnZW5kLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICAgbWFwLm9uKCdpZGxlJywgdXBkYXRlTGVnZW5kVmlzaWJpbGl0eSk7XG4gICAgICAgIFxuICAgICAgICAvLyBDcsOpZXIgbGUgY29udGVuZXVyIGRlIGzDqWdlbmRlIGRlcyBiw6J0aW1lbnRzXG4gICAgICAgIGNvbnN0IGJhdGltZW50TGVnZW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLmlkID0gJ2JhdGltZW50LWxlZ2VuZCc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUudG9wID0gJzgxJSc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLmxlZnQgPSAnMTBweCc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKC01MCUpJztcbiAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XG4gICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLmZvbnRTaXplID0gJzEycHgnO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnNHB4JztcbiAgICAgICAgYmF0aW1lbnRMZWdlbmQuc3R5bGUuYm94U2hhZG93ID0gJzAgMXB4IDRweCByZ2JhKDAsMCwwLDAuMyknO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS56SW5kZXggPSAnMSc7XG4gICAgICAgIFxuICAgICAgICAvLyBDb250ZW51IGRlIGxhIGzDqWdlbmRlXG4gICAgICAgIGJhdGltZW50TGVnZW5kLmlubmVySFRNTCA9IGBcbiAgICAgICAgICA8c3Ryb25nPlR5cGUgZGUgYsOidGltZW50PC9zdHJvbmc+PGJyPlxuICAgICAgICAgIDxkaXY+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kOiMxZjc3YjQ7d2lkdGg6MTJweDtoZWlnaHQ6MTJweDtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6NXB4O1wiPjwvc3Bhbj4gQWN0aXZpdMOpPC9kaXY+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6IzJjYTAyYzt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7XCI+PC9zcGFuPiBBcHBhcnRlbWVudDwvZGl2PlxuICAgICAgICAgIDxkaXY+PHNwYW4gc3R5bGU9XCJiYWNrZ3JvdW5kOiNkOWQ5ZDk7d2lkdGg6MTJweDtoZWlnaHQ6MTJweDtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW4tcmlnaHQ6NXB4O1wiPjwvc3Bhbj4gQXVjdW4gbG9jYWw8L2Rpdj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojOTQ2N2JkO3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtcIj48L3NwYW4+IETDqXBlbmRhbmNlPC9kaXY+XG4gICAgICAgICAgPGRpdj48c3BhbiBzdHlsZT1cImJhY2tncm91bmQ6I2ZmN2YwZTt3aWR0aDoxMnB4O2hlaWdodDoxMnB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbi1yaWdodDo1cHg7XCI+PC9zcGFuPiBNYWlzb248L2Rpdj5cbiAgICAgICAgICA8ZGl2PjxzcGFuIHN0eWxlPVwiYmFja2dyb3VuZDojZTM3N2MyO3dpZHRoOjEycHg7aGVpZ2h0OjEycHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0OjVweDtcIj48L3NwYW4+IE1peHRlPC9kaXY+XG4gICAgICAgIGA7XG4gICAgICAgIFxuICAgICAgICAvLyBM4oCZYWpvdXRlciDDoCBsYSBjYXJ0ZVxuICAgICAgICBtYXAuZ2V0Q29udGFpbmVyKCkuYXBwZW5kQ2hpbGQoYmF0aW1lbnRMZWdlbmQpO1xuICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAvLyBQZXJtZXQgZGUgc3VwcHJpbWVyIGwnYWZmaWNoYWdlIGRlIGxhIGzDqWdlbmRlIGF1IGNoYXJnZW1lbnQgZGUgbGEgcGFnZVxuICAgICAgICBcbiAgICAgICAgLy8gTGllciBsYSB2aXNpYmlsaXTDqSDDoCBsYSBjb3VjaGUgYsOidGltZW50XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJhdGltZW50TGVnZW5kVmlzaWJpbGl0eSgpIHtcbiAgICAgICAgICBjb25zdCB2aXNpYmlsaXR5ID0gbWFwLmdldExheW91dFByb3BlcnR5KCdiYXRpbWVudHNMYXllcicsICd2aXNpYmlsaXR5Jyk7XG4gICAgICAgICAgLy9iYXRpbWVudExlZ2VuZC5zdHlsZS5kaXNwbGF5ID0gKHZpc2liaWxpdHkgPT09ICdub25lJykgPyAnbm9uZScgOiAnYmxvY2snO1xuICAgICAgICAgIGlmICh2aXNpYmlsaXR5ID09PSAnbm9uZScpIHtcbiAgICAgICAgICBiYXRpbWVudExlZ2VuZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJhdGltZW50TGVnZW5kLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIG1hcC5vbignaWRsZScsIHVwZGF0ZUJhdGltZW50TGVnZW5kVmlzaWJpbGl0eSk7XG4gICAgIFxuICAgIC8vIEFqb3V0IGRlcyBjb3VjaGVzIHZlY3RvcmllbGxlc1xuICAgICAgbGF5ZXJzRGF0YS5mb3JFYWNoKGxheWVyID0+IHtcbiAgICAgICAgbWFwLmFkZFNvdXJjZShsYXllci5pZCwge1xuICAgICAgICAgIHR5cGU6ICdnZW9qc29uJyxcbiAgICAgICAgICBkYXRhOiBsYXllci5kYXRhXG4gICAgICAgIH0pO1xuICAgICAgXG4gICAgICAgIGNvbnN0IGxheWVyQ29uZmlnID0ge1xuICAgICAgICAgIGlkOiBsYXllci5pZCxcbiAgICAgICAgICB0eXBlOiBsYXllci50eXBlLFxuICAgICAgICAgIHNvdXJjZTogbGF5ZXIuaWQsXG4gICAgICAgICAgcGFpbnQ6IHt9LFxuICAgICAgICAgIGxheW91dDogbGF5ZXIubGF5b3V0XG4gICAgICAgIH07XG4gICAgICBcbiAgICAgICAgaWYgKGxheWVyLnR5cGUgPT09ICdmaWxsJykge1xuICAgICAgICAgIGlmIChsYXllci5keW5hbWljQ29sb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHByb3AgPSBbJ2dldCcsIGxheWVyLmR5bmFtaWNDb2xvci5wcm9wZXJ0eV07XG4gICAgICAgICAgICBsYXllckNvbmZpZy5wYWludFsnZmlsbC1jb2xvciddID0gW1xuICAgICAgICAgICAgICAnY2FzZScsXG4gICAgICAgICAgICAgIFsnIScsIFsnaGFzJywgbGF5ZXIuZHluYW1pY0NvbG9yLnByb3BlcnR5XV0sICcjZDlkOWQ5JywgICAgICAgICAgICAgICAgICAgICAgIC8vIFByb3ByacOpdMOpIGFic2VudGVcbiAgICAgICAgICAgICAgWydhbnknLCBbJz09JywgWydnZXQnLCBsYXllci5keW5hbWljQ29sb3IucHJvcGVydHldLCBudWxsXSwgWyc9PScsIFsnZ2V0JywgbGF5ZXIuZHluYW1pY0NvbG9yLnByb3BlcnR5XSwgMF1dLCAnI2Q5ZDlkOScsIC8vIG51bGwgb3UgMFxuICAgICAgICAgICAgICBbJzwnLCBbJ2dldCcsIGxheWVyLmR5bmFtaWNDb2xvci5wcm9wZXJ0eV0sIDJdLCAnI2ZmZDcwMCcsXG4gICAgICAgICAgICAgIFsnPj0nLCBbJ2dldCcsIGxheWVyLmR5bmFtaWNDb2xvci5wcm9wZXJ0eV0sIDJdLCAnI2ZmNzYwMCcsXG4gICAgICAgICAgICAgICcjZDlkOWQ5JyAvLyBmYWxsYmFja1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtY29sb3InXSA9IGxheWVyLmNvbG9yIHx8ICcjMDAwMDAwJztcbiAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgIGxheWVyQ29uZmlnLnBhaW50WydmaWxsLW9wYWNpdHknXSA9IGxheWVyLm9wYWNpdHkgfHwgMC40O1xuICAgICAgICAgIGxheWVyQ29uZmlnLnBhaW50WydmaWxsLW91dGxpbmUtY29sb3InXSA9ICcjMDAwMDAwJztcbiAgICAgICAgXG4gICAgICAgIH0gZWxzZSBpZiAobGF5ZXIudHlwZSA9PT0gJ2xpbmUnKSB7XG4gICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2xpbmUtY29sb3InXSA9IGxheWVyLmNvbG9yIHx8ICcjMDAwMDAwJztcbiAgICAgICAgICBsYXllckNvbmZpZy5wYWludFsnbGluZS13aWR0aCddID0gbGF5ZXIud2lkdGggfHwgMTtcbiAgICAgICAgfSBlbHNlIGlmIChsYXllci50eXBlID09PSAnZmlsbC1leHRydXNpb24nKSB7XG4gICAgICAgICAgaWYgKGxheWVyLmNvbG9yQnlUeXBlID09PSAnZmZfZHRlbG9jdHh0Jykge1xuICAgICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtZXh0cnVzaW9uLWNvbG9yJ10gPSBbXG4gICAgICAgICAgICAgICdtYXRjaCcsXG4gICAgICAgICAgICAgIFsnZ2V0JywgJ2ZmX2R0ZWxvY3R4dCddLFxuICAgICAgICAgICAgICAnQUNUSVZJVEUnLCAnIzFmNzdiNCcsXG4gICAgICAgICAgICAgICdBUFBBUlRFTUVOVCcsICcjMmNhMDJjJyxcbiAgICAgICAgICAgICAgJ0FVQ1VOIExPQ0FMJywgJyNkOWQ5ZDknLFxuICAgICAgICAgICAgICAnREVQRU5EQU5DRScsICcjOTQ2N2JkJyxcbiAgICAgICAgICAgICAgJ01BSVNPTicsICcjZmY3ZjBlJyxcbiAgICAgICAgICAgICAgJ01JWFRFJywgJyNlMzc3YzInLFxuICAgICAgICAgICAgICAnIzAwMDAwMCcgLy8gZmFsbGJhY2tcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxheWVyQ29uZmlnLnBhaW50WydmaWxsLWV4dHJ1c2lvbi1jb2xvciddID0gbGF5ZXIuY29sb3IgfHwgJyMwMDAwMDAnO1xuICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgbGF5ZXJDb25maWcucGFpbnRbJ2ZpbGwtZXh0cnVzaW9uLWhlaWdodCddID0gWydnZXQnLCBsYXllci5oZWlnaHRQcm9wZXJ0eSB8fCAnaGF1dGV1ciddO1xuICAgICAgICAgIGxheWVyQ29uZmlnLnBhaW50WydmaWxsLWV4dHJ1c2lvbi1iYXNlJ10gPSAwO1xuICAgICAgICAgIGxheWVyQ29uZmlnLnBhaW50WydmaWxsLWV4dHJ1c2lvbi1vcGFjaXR5J10gPSBsYXllci5vcGFjaXR5IHx8IDAuOTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1hcC5hZGRMYXllcihsYXllckNvbmZpZyk7XG4gICAgICAgIFxuICAgICAgICAgbWFwLmFkZExheWVyKHtcbiAgICAgICAgICAgICAgICAgIGlkOiAnaW5kaWNhdGV1cnMyNWRMYWJlbHMnLFxuICAgICAgICAgICAgICAgICAgdHlwZTogJ3N5bWJvbCcsXG4gICAgICAgICAgICAgICAgICBzb3VyY2U6ICdpbmRpY2F0ZXVyczI1ZExheWVyJywgLy8gbGUgbcOqbWUgaWQgcXVlIHRhIHNvdXJjZSBHZW9KU09OXG4gICAgICAgICAgICAgICAgICBsYXlvdXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQtZmllbGQnOiBbJ2dldCcsICdub20nXSxcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQtc2l6ZSc6IDExLFxuICAgICAgICAgICAgICAgICAgICAndGV4dC1mb250JzogWydPcGVuIFNhbnMgQm9sZCcsICdBcmlhbCBVbmljb2RlIE1TIEJvbGQnXSxcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQtb2Zmc2V0JzogWzAsIDAuNl0sXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWFuY2hvcic6ICd0b3AnXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcGFpbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgJ3RleHQtY29sb3InOiAnIzAwMDAwMCcsXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWhhbG8tY29sb3InOiAnI2ZmZmZmZicsXG4gICAgICAgICAgICAgICAgICAgICd0ZXh0LWhhbG8td2lkdGgnOiAxXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIG1hcC5hZGRMYXllcih7XG4gICAgICAgICAgICAgICAgIGlkOiAnaW5kaWNhdGV1cnMyNWQtaG92ZXInLFxuICAgICAgICAgICAgICAgICB0eXBlOiAnbGluZScsXG4gICAgICAgICAgICAgICAgIHNvdXJjZTogJ2luZGljYXRldXJzMjVkTGF5ZXInLCAvLyBtw6ptZSBzb3VyY2VcbiAgICAgICAgICAgICAgICAgcGFpbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAnbGluZS1jb2xvcic6ICcjMDAwJyxcbiAgICAgICAgICAgICAgICAgICAnbGluZS13aWR0aCc6IDJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgIGZpbHRlcjogWyc9PScsICdub20nLCAnJ10gLy8gdmlkZSBhdSBkw6lidXRcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICBtYXAub24oJ2NsaWNrJywgJ2luZGljYXRldXJzMjVkTGF5ZXInLCAoZSkgPT4ge1xuICAgICAgICBjb25zdCBmZWF0dXJlID0gZS5mZWF0dXJlc1swXTtcbiAgICAgICAgY29uc3QgaW1hZ2U9IGZlYXR1cmUucHJvcGVydGllcy5pbWFnZTtcbiAgICAgICAgY29uc3Qgbm9tID0gZmVhdHVyZS5wcm9wZXJ0aWVzLm5vbSB8fCAnTm9uIGRpc3BvbmlibGUnO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcG9wdWxhdGlvbiA9IGZlYXR1cmUucHJvcGVydGllcy5wb3B1bGF0aW9uXG4gICAgICAgICAgPyBmZWF0dXJlLnByb3BlcnRpZXMucG9wdWxhdGlvbi50b0xvY2FsZVN0cmluZygnZnItRlInKSArICcgaGFiaXRhbnRzJ1xuICAgICAgICAgIDogJ05vbiBkaXNwb25pYmxlJztcbiAgICAgIFxuICAgICAgICBjb25zdCBzMjVkVmFsdWUgPSBwYXJzZUZsb2F0KGZlYXR1cmUucHJvcGVydGllcy5zMjVkKTtcbiAgICAgICAgY29uc3QgZG9tbWFnZXMgPSAoTnVtYmVyKHMyNWRWYWx1ZSkgfHwgMCkudG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJyk7XG4gICAgICAgIGNvbnN0IGJhdGltZW50c1ZhbHVlID0gZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdGltZW50cztcbiAgICAgICAgY29uc3QgYmF0aW1lbnRzID0gIWlzTmFOKHBhcnNlRmxvYXQoYmF0aW1lbnRzVmFsdWUpKVxuICAgICAgICAgID8gcGFyc2VJbnQoYmF0aW1lbnRzVmFsdWUpLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpXG4gICAgICAgICAgOiAnTm9uIGRpc3BvbmlibGUnO1xuICAgICAgICBjb25zdCBiYXRpbmRpZiA9IGZlYXR1cmUucHJvcGVydGllcy5uYl9iYXRfaW5kaWY/LnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgICBjb25zdCBiYXRzcG9ydGlmVmFsdWUgPSBwYXJzZUZsb2F0KGZlYXR1cmUucHJvcGVydGllcy5uYl9iYXRfc3BvcnRpZik7XG4gICAgICAgIGNvbnN0IGJhdHNwb3J0aWYgPSAoIWlzTmFOKGJhdHNwb3J0aWZWYWx1ZSkgPyBiYXRzcG9ydGlmVmFsdWUgOiAwKS50b0xvY2FsZVN0cmluZygnZnItRlInKTtcbiAgICAgICAgY29uc3QgYmF0YWdyaWNvbGVmVmFsdWUgPSBwYXJzZUZsb2F0KGZlYXR1cmUucHJvcGVydGllcy5uYl9iYXRfYWdyaWNvbGUpO1xuICAgICAgICBjb25zdCBiYXRhZ3JpY29sZSA9ICghaXNOYU4oYmF0YWdyaWNvbGVmVmFsdWUpID8gYmF0YWdyaWNvbGVmVmFsdWUgOiAwKS50b0xvY2FsZVN0cmluZygnZnItRlInKTtcbiAgICAgICAgY29uc3QgYmF0cmVzaWRlbnRpZWxWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9yZXNpZGVudGllbCk7XG4gICAgICAgIGNvbnN0IGJhdHJlc2lkZW50aWVsID0gKCFpc05hTihiYXRyZXNpZGVudGllbFZhbHVlKSA/IGJhdHJlc2lkZW50aWVsVmFsdWUgOiAwKS50b0xvY2FsZVN0cmluZygnZnItRlInKTtcbiAgICAgICAgY29uc3QgYmF0YW5uZXhlVmFsdWUgPSBwYXJzZUZsb2F0KGZlYXR1cmUucHJvcGVydGllcy5uYl9iYXRfYW5uZXhlKTtcbiAgICAgICAgY29uc3QgYmF0YW5uZXhlID0gKCFpc05hTihiYXRhbm5leGVWYWx1ZSkgPyBiYXRhbm5leGVWYWx1ZSA6IDApLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgICBjb25zdCBiYXRyZWxpZ2lldXhWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9yZWxpZ2lldXgpO1xuICAgICAgICBjb25zdCBiYXRyZWxpZ2lldXggPSAoIWlzTmFOKGJhdHJlbGlnaWV1eFZhbHVlKSA/IGJhdHJlbGlnaWV1eFZhbHVlIDogMCkudG9Mb2NhbGVTdHJpbmcoJ2ZyLUZSJyk7XG4gICAgICAgIGNvbnN0IGJhdGluZHVzdHJpZWxWYWx1ZSA9IHBhcnNlRmxvYXQoZmVhdHVyZS5wcm9wZXJ0aWVzLm5iX2JhdF9pbmR1c3RyaWVsKTtcbiAgICAgICAgY29uc3QgYmF0aW5kdXN0cmllbCA9ICghaXNOYU4oYmF0aW5kdXN0cmllbFZhbHVlKSA/IGJhdGluZHVzdHJpZWxWYWx1ZSA6IDApLnRvTG9jYWxlU3RyaW5nKCdmci1GUicpO1xuICAgICAgICBjb25zdCBiYXRjb21tZXJjaWFsVmFsdWUgPSBwYXJzZUZsb2F0KGZlYXR1cmUucHJvcGVydGllcy5uYl9iYXRfY29tbWVyY2lhbCk7XG4gICAgICAgIGNvbnN0IGJhdGNvbW1lcmNpYWwgPSAoIWlzTmFOKGJhdGNvbW1lcmNpYWxWYWx1ZSkgPyBiYXRjb21tZXJjaWFsVmFsdWUgOiAwKS50b0xvY2FsZVN0cmluZygnZnItRlInKTtcbiAgICAgIFxuICAgICAgICBjb25zdCBwb3B1cENvbnRlbnQgPSBgXG4gICAgICAgIDxzdHlsZT5cbiAgICAgICAgICAubWFwbGlicmVnbC1wb3B1cC1jb250ZW50IHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDRweCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQ7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7XG4gICAgICAgICAgICB3aWR0aDogbWF4LWNvbnRlbnQ7XG4gICAgICAgICAgICBib3gtc2hhZG93OiByZ2JhKDEwMSwgMTQ3LCAyMjAsIDAuMikgMHB4IDRweCA4cHggMHB4O1xuICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDEwMSwgMTQ3LCAyMjAsIDAuNSk7XG4gICAgICAgICAgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogc2Fucy1zZXJpZjsgZm9udC1zaXplOiAxM3B4OyBtYXJnaW46MTBweDtcIj5cbiAgICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzY5Nzc0ZjsgYm9yZGVyOiAxcHggc29saWQ7IGJvcmRlci1yYWRpdXM6OHB4OyBtYXJnaW4tYm90dG9tOjE2cHg7IHBhZGRpbmc6MTBweDsgY29sb3I6d2hpdGU7XCI+PHN0cm9uZz5cbiAgICAgICAgICA8Y2VudGVyPiR7bm9tfTwvY2VudGVyPlxuICAgICAgICAgIDwvc3Ryb25nPjwvZGl2PlxuICAgICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW46YXV0bztcIj48c3Ryb25nPlBvcHVsYXRpb24gOjwvc3Ryb25nPiAke3BvcHVsYXRpb259PC9wPlxuICAgICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW46YXV0bztcIj48c3Ryb25nPk5vbWJyZSBkZSBzdGF0aW9ucyBk4oCZYWxpbWVudGF0aW9uIDxicj4gZW4gZWF1IHBvdGFibGUgKEFFUCkgZW4gem9uZSBpbm9uZGFibGUgXG4gOjwvc3Ryb25nPiAke2RvbW1hZ2VzfTwvcD5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcbiAgICAgIFxuICAgICAgICBuZXcgbWFwbGlicmVnbC5Qb3B1cCh7Y2xvc2VCdXR0b246IGZhbHNlfSlcbiAgICAgICAgICAuc2V0TG5nTGF0KGUubG5nTGF0KVxuICAgICAgICAgIC5zZXRIVE1MKHBvcHVwQ29udGVudClcbiAgICAgICAgICAuYWRkVG8obWFwKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBNZXR0cmUgw6Agam91ciBsZSBjb250ZW5ldXIgSFRNTCBhdmVjIGxlcyBpbmZvcm1hdGlvbnMgc3DDqWNpZmlxdWVzIGR1IG1hcnF1ZXVyIFxuICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvbm5lZXMnKS5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyOyBmb250LWZhbWlseTpzYW5zLXNlcmlmOyBmb250LXNpemU6MTZweDtcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8aW1nIHNyYz1cIiR7aW1hZ2V9XCIgc3R5bGU9XCJ3aWR0aDozMDBweDsgbWFyZ2luLWJvdHRvbToxMHB4O3BhZGRpbmc6IDJweDsgYmFja2dyb3VuZC1jb2xvcjogZGFya2dvbGRlbnJvZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMTNweDtib3gtc2hhZG93OiByZ2JhKDE0OSwgMzEsIDgxLCAwLjc3KSAwcHggNHB4IDhweCAwcHg7XCI+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxicj5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgPHN0cm9uZyBzdHlsZT1cImZvbnQtc2l6ZToxLjFlbTtcIj48aSBjbGFzcz1cImJpIGJpLWdlby1hbHQtZmlsbFwiPjwvaT4gQ29tbXVuZSA6PC9zdHJvbmc+ICR7bm9tfTxicj5cbiAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9XCJmb250LXNpemU6MS4xZW07XCI+PGkgY2xhc3M9XCJiaSBiaS1wZW9wbGUtZmlsbFwiPjwvaT4gTm9tYnJlIGQnaGFiaXRhbnRzIDo8L3N0cm9uZz4gJHtwb3B1bGF0aW9ufTxicj5cbiAgICAgICAgICAgIDxzdHJvbmcgc3R5bGU9XCJmb250LXNpemU6MS4xZW07XCI+PGkgY2xhc3M9XCJiaSBiaS1ob3VzZS1maWxsXCI+PC9pPiBOb21icmUgZGUgYsOidGltZW50cyA6PC9zdHJvbmc+ICR7YmF0aW1lbnRzfTxicj5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6MTBweDtcIj48c3Ryb25nPkRvbnQgOjwvc3Ryb25nPjwvZGl2PlxuICAgICAgICAgICAgPHVsIHN0eWxlPVwibGlzdC1zdHlsZTpub25lOyBwYWRkaW5nOjA7XCI+XG4gICAgICAgICAgICAgIDxsaT48aDUgc3R5bGU9XCJmb250LXNpemU6MWVtO1wiPiR7YmF0aW5kaWZ9IDxzdHJvbmc+YsOidGltZW50cyBpbmRpZmbDqXJlbmNpw6lzPC9zdHJvbmc+PC9oNT48L2xpPlxuICAgICAgICAgICAgICA8bGk+PGg1IHN0eWxlPVwiZm9udC1zaXplOjFlbTtcIj4ke2JhdHNwb3J0aWZ9IDxzdHJvbmc+YsOidGltZW50cyBzcG9ydGlmczwvc3Ryb25nPjwvaDU+PC9saT5cbiAgICAgICAgICAgICAgPGxpPjxoNSBzdHlsZT1cImZvbnQtc2l6ZToxZW07XCI+JHtiYXRhZ3JpY29sZX0gPHN0cm9uZz5iw6J0aW1lbnRzIGFncmljb2xlczwvc3Ryb25nPjwvaDU+PC9saT5cbiAgICAgICAgICAgICAgPGxpPjxoNSBzdHlsZT1cImZvbnQtc2l6ZToxZW07XCI+JHtiYXRyZXNpZGVudGllbH0gPHN0cm9uZz5iw6J0aW1lbnRzIHLDqXNpZGVudGllbHM8L3N0cm9uZz48L2g1PjwvbGk+XG4gICAgICAgICAgICAgIDxsaT48aDUgc3R5bGU9XCJmb250LXNpemU6MWVtO1wiPiR7YmF0YW5uZXhlfSA8c3Ryb25nPmLDonRpbWVudHMgYW5uZXhlczwvc3Ryb25nPjwvaDU+PC9saT5cbiAgICAgICAgICAgICAgPGxpPjxoNSBzdHlsZT1cImZvbnQtc2l6ZToxZW07XCI+JHtiYXRyZWxpZ2lldXh9IDxzdHJvbmc+YsOidGltZW50cyByZWxpZ2lldXg8L3N0cm9uZz48L2g1PjwvbGk+XG4gICAgICAgICAgICAgIDxsaT48aDUgc3R5bGU9XCJmb250LXNpemU6MWVtO1wiPiR7YmF0aW5kdXN0cmllbH0gPHN0cm9uZz5iw6J0aW1lbnRzIGluZHVzdHJpZWxzPC9zdHJvbmc+PC9oNT48L2xpPlxuICAgICAgICAgICAgICA8bGk+PGg1IHN0eWxlPVwiZm9udC1zaXplOjFlbTtcIj4ke2JhdGNvbW1lcmNpYWx9IDxzdHJvbmc+YsOidGltZW50cyBjb21tZXJjaWF1eDwvc3Ryb25nPjwvaDU+PC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIFxuICAgICAgICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi10b3A6MTBweDtcIj5cbiAgICAgICAgICAgICAgPHN0cm9uZyBzdHlsZT1cImZvbnQtc2l6ZToxLjFlbTtcIj48aSBjbGFzcz1cImZhcyBmYS10aW50XCI+PC9pPiBOb21icmUgZGUgc3RhdGlvbnMgZOKAmWFsaW1lbnRhdGlvbiBlbiBlYXUgcG90YWJsZSAoQUVQKSBlbiB6b25lIGlub25kYWJsZSAgOjwvc3Ryb25nPiAke2RvbW1hZ2VzfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgICB9KTtcblxuICAgICAgbWFwLm9uKCdtb3VzZW1vdmUnLCAnaW5kaWNhdGV1cnMyNWRMYXllcicsIChlKSA9PiB7XG4gICAgICAgIGlmIChlLmZlYXR1cmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBub21Db21tdW5lID0gZS5mZWF0dXJlc1swXS5wcm9wZXJ0aWVzLm5vbTtcbiAgICAgIFxuICAgICAgICAgIG1hcC5zZXRGaWx0ZXIoJ2luZGljYXRldXJzMjVkLWhvdmVyJywgWyc9PScsICdub20nLCBub21Db21tdW5lXSk7XG4gICAgICBcbiAgICAgICAgICBtYXAuZ2V0Q2FudmFzKCkuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgICBtYXAub24oJ21vdXNlbGVhdmUnLCAnaW5kaWNhdGV1cnMyNWRMYXllcicsICgpID0+IHtcbiAgICAgICAgICBtYXAuc2V0RmlsdGVyKCdpbmRpY2F0ZXVyczI1ZC1ob3ZlcicsIFsnPT0nLCAnbm9tJywgJyddKTtcbiAgICAgICAgICBtYXAuZ2V0Q2FudmFzKCkuc3R5bGUuY3Vyc29yID0gJyc7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAvLyBJbnRlcmZhY2UgZGUgY29udHLDtGxlIGRlcyBjb3VjaGVzXG4gICAgY29uc3QgbWFwTGF5ZXJzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbWFwTGF5ZXJzRGl2LmNsYXNzTGlzdC5hZGQoJ21hcExheWVycycpO1xuICAgIG1hcExheWVyc0Rpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgbWFwTGF5ZXJzRGl2LnN0eWxlLnpJbmRleCA9ICcxMDAwJztcbiAgICBtYXBMYXllcnNEaXYuaW5uZXJIVE1MID0gYFxuICAgICAgPGJ1dHRvbiBpZD1cInRvZ2dsZU1hcE1lbnVCdXR0b25cIiBjbGFzcz1cImJ0biBidG4tbGlnaHQgYXJpYS1sYWJlbD1cIkFmZmljaGVyIGxlcyBjb3VjaGVzXCIgdGl0bGU9XCJBZmZpY2hlciBsZXMgY291Y2hlc1wiPlxuICAgICAgICA8aW1nIHNyYz1cIkltYWdlcy9pY29ucy9sYXllcnMtaGFsZi5zdmdcIiBhbHQ9XCJJY8O0bmUgU1ZHXCIgd2lkdGg9XCIyNVwiIGhlaWdodD1cIjI1XCI+XG4gICAgICA8L2J1dHRvbj5cbiAgICAgIDxkaXYgaWQ9XCJsYXllcnNMaXN0XCIgc3R5bGU9XCJkaXNwbGF5OiBub25lOyBiYWNrZ3JvdW5kOiB3aGl0ZTsgcGFkZGluZzogMTBweDsgYm9yZGVyOiAxcHggc29saWQgI2NjYztcIj48L2Rpdj5cbiAgICBgO1xuICAgIG1hcC5nZXRDb250YWluZXIoKS5hcHBlbmRDaGlsZChtYXBMYXllcnNEaXYpO1xuXG4gICAgY29uc3QgdG9nZ2xlYWJsZUxheWVySWRzID0gbGF5ZXJzRGF0YS5tYXAobGF5ZXIgPT4gbGF5ZXIuaWQpO1xuICAgIGNvbnN0IGFsaWFzTGF5ZXJJZHMgPSB7XG4gICAgICBiYXNzaW52aWVubmVMYXllcjogJ0Jhc3NpbiBkZSBsYSBWaWVubmUnLFxuICAgICAgcmVnaW9uTGF5ZXI6ICdSw6lnaW9uJyxcbiAgICAgIGRlcGFydGVtZW50TGF5ZXI6ICdEw6lwYXJ0ZW1lbnQnLFxuICAgICAgZXBjaUxheWVyOiAnRXRhYmxpc3NlbWVudCBQdWJsaWMgZGUgQ29vcMOpcmF0aW9uIEludGVyY29tbXVuYWxlJyxcbiAgICAgIGNvdXJzZGVhdUxheWVyOiBcIkNvdXJzIGQnZWF1XCIsXG4gICAgICB6b25laW5vbmRhYmxlTGF5ZXI6ICdab25hZ2UgSW5vbmRhYmxlJyxcbiAgICAgIGluZGljYXRldXJzMjVkTGF5ZXI6IFwiTm9tYnJlIGRlIHN0YXRpb25zIGTigJlhbGltZW50YXRpb24gZW4gZWF1IHBvdGFibGUgKEFFUCkgZW4gem9uZSBpbm9uZGFibGVcIixcbiAgICAgIGJhdGltZW50c0xheWVyOiBcIkLDonRpbWVudHNcIlxuICAgIH07XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVMYXllclZpc2liaWxpdHkoaWQsIHZpc2libGUpIHtcbiAgICAgIGNvbnN0IHZpc2liaWxpdHkgPSB2aXNpYmxlID8gJ3Zpc2libGUnIDogJ25vbmUnO1xuICAgICAgaWYgKG1hcC5nZXRMYXllcihpZCkpIHtcbiAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KGlkLCAndmlzaWJpbGl0eScsIHZpc2liaWxpdHkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGxheWVyc0xpc3REaXYgPSBtYXBMYXllcnNEaXYucXVlcnlTZWxlY3RvcignI2xheWVyc0xpc3QnKTtcbiAgICBcbiAgICB0b2dnbGVhYmxlTGF5ZXJJZHMuZm9yRWFjaChpZCA9PiB7XG4gICAgICBjb25zdCBuYW1lID0gYWxpYXNMYXllcklkc1tpZF0gfHwgaWQ7XG5cbiAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIGNoZWNrYm94LnR5cGUgPSAnY2hlY2tib3gnO1xuICAgICAgY2hlY2tib3guaWQgPSBpZDtcbiAgICAgIGNoZWNrYm94LmNsYXNzTmFtZSA9ICdmb3JtLWNoZWNrLWlucHV0JztcbiAgICAgIFxuICAgICAgLy8g4pyFIExpcmUgbGEgdmlzaWJpbGl0w6kgYWN0dWVsbGUgZGlyZWN0ZW1lbnQgZGFucyBsYSBjYXJ0ZVxuICAgICAgbWFwLm9uY2UoJ2lkbGUnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHZpc2liaWxpdHkgPSBtYXAuZ2V0TGF5b3V0UHJvcGVydHkoaWQsICd2aXNpYmlsaXR5Jyk7XG4gICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSB2aXNpYmlsaXR5ID09PSAndmlzaWJsZSc7XG4gICAgICB9KTtcbiAgXG4gICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB0b2dnbGVMYXllclZpc2liaWxpdHkoaWQsIGNoZWNrYm94LmNoZWNrZWQpKTtcblxuICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICAgICAgbGFiZWwuaHRtbEZvciA9IGlkO1xuICAgICAgbGFiZWwuY2xhc3NOYW1lID0gJ2Zvcm0tY2hlY2stbGFiZWwnO1xuICAgICAgbGFiZWwuaW5uZXJUZXh0ID0gbmFtZTtcblxuICAgICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgd3JhcHBlci5jbGFzc05hbWUgPSAnZm9ybS1jaGVjayc7XG4gICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGNoZWNrYm94KTtcbiAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQobGFiZWwpO1xuXG4gICAgICBsYXllcnNMaXN0RGl2LmFwcGVuZENoaWxkKHdyYXBwZXIpO1xuICAgIH0pO1xuXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZU1hcE1lbnVCdXR0b24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGxheWVyc0xpc3REaXYuc3R5bGUuZGlzcGxheSA9IGxheWVyc0xpc3REaXYuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnID8gJ2Jsb2NrJyA6ICdub25lJztcbiAgICB9KTtcbiAgICAgXG5cbiAgICAvLyBNZW51IGJhc2N1bGUgZm9uZCBkZSBwbGFuXG4gICAgY29uc3QgbWFwTWVudURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIG1hcE1lbnVEaXYuY2xhc3NMaXN0LmFkZCgnbWFwRm9uZERlUGxhbicpO1xuICAgIG1hcE1lbnVEaXYuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgIG1hcE1lbnVEaXYuc3R5bGUuekluZGV4ID0gJzEwMDAnO1xuICAgIG1hcE1lbnVEaXYuaW5uZXJIVE1MID0gYFxuICAgICAgPHN0cm9uZz5Gb25kIGRlIHBsYW4gOjwvc3Ryb25nPlxuICAgICAgPGRpdiBjbGFzcz1cImZvcm0tY2hlY2sgZm9ybS1zd2l0Y2hcIj5cbiAgICAgICAgPGlucHV0IGNsYXNzPVwiZm9ybS1jaGVjay1pbnB1dFwiIHR5cGU9XCJjaGVja2JveFwiIHJvbGU9XCJzd2l0Y2hcIiBpZD1cIm9ydGhvQ2hlY2tib3hcIj5cbiAgICAgICAgPGxhYmVsIGNsYXNzPVwiZm9ybS1jaGVjay1sYWJlbFwiIGZvcj1cIm9ydGhvQ2hlY2tib3hcIj5QaG90b3MgYcOpcmllbm5lczwvbGFiZWw+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuICAgIG1hcC5nZXRDb250YWluZXIoKS5hcHBlbmRDaGlsZChtYXBNZW51RGl2KTtcblxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcnRob0NoZWNrYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0b2dnbGVTdHlsZSh0aGlzLmNoZWNrZWQpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYFxuPGRpdiBpZD1cImRvbm5lZXNcIiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgZm9udC1zaXplOiAxNnB4OyBsaW5lLWhlaWdodDogMS41OyBtYXJnaW4tdG9wOjElO1wiPlxuICAgIENsaXF1ZXogc3VyIHVuZSBjb21tdW5lIHBvdXIgdm9pciBsZXMgaW5mb3JtYXRpb25zIGljaS48YnI+XG48L2Rpdj5cblxuYFxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbmltcG9ydCB7IFBsb3QgYXMgUGxvdFRhdXggfSBmcm9tIFwiQG9ic2VydmFibGVocS9wbG90XCI7XG5pbXBvcnQgeyBJbnB1dHMgYXMgSW5wdXRzVGF1eCB9IGZyb20gXCJAb2JzZXJ2YWJsZWhxL2lucHV0c1wiO1xuXG4vLyBDaGFyZ2VyIGxlcyBkb25uw6llc1xuZGF0YSA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2RhdGFfczI1ZC5qc29uXCIpLmpzb24oKVxuXG4vLyBMYWJlbCBkdSBzbGlkZXJcbmh0bWxgPGxhYmVsIGZvcj1cInNsaWRlci1zMjVkXCIgc3R5bGU9XCJkaXNwbGF5OiBibG9jaztcbiAgbWFyZ2luLXRvcDogMWVtO1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgbWFyZ2luLWJvdHRvbTogMWVtO1xuICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuNik7XG4gIGJveC1zaGFkb3c6IDBweCAwcHggOHB4IDBweCByZ2JhKDAsIDAsIDAsIDAuOCk7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgcGFkZGluZzogNXB4O1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIG1hcmdpbi1yaWdodDogMjAlO1xuICBtYXJnaW4tbGVmdDogMjAlO1wiPlxuICBOb21icmUgZGUgc3RhdGlvbnMgZOKAmWFsaW1lbnRhdGlvbiBlbiBlYXUgcG90YWJsZSAoQUVQKSBlbiB6b25lIGlub25kYWJsZVxuPC9sYWJlbD5gXG5cbi8vIFNsaWRlclxuXG5cbmRhdGFfczI1ZCA9IEZpbGVBdHRhY2htZW50KFwibGF5ZXJzL2RhdGFfczI1ZC5qc29uXCIpLmpzb24oKVxuXG52aWV3b2Ygc2xpZGVyX3MyNWQgPSBJbnB1dHNUYXV4LnJhbmdlKFswLCAzXSwge1xuICB2YWx1ZTogMixcbiAgc3RlcDogMS8vXG4gIC8vbGFiZWw6IFwiTGluw6lhaXJlIGQnaXRpbsOpcmFpcmVzIHJvdXRpZXJzIGludGVyY2VwdMOpcyBlbiBrbVwiXG59KVxuXG5zb3J0ZWRfczI1ZCA9IGRhdGFfczI1ZFxuICAubWFwKGQgPT4gKHsgLi4uZCwgczI1ZDogK2QuczI1ZCB8fCAwIH0pKVxuICAuZmlsdGVyKGQgPT4gZC5zMjVkIDw9IHNsaWRlcl9zMjVkKVxuICAuc29ydCgoYSwgYikgPT4gYS5zMjVkIC0gYi5zMjVkKVxuXG5QbG90VGF1eC5wbG90KHtcbiAgbWFya3M6IFtcbiAgICBQbG90VGF1eC5iYXJZKHNvcnRlZF9zMjVkLCB7XG4gICAgICB4OiBkID0+IGQubm9tLFxuICAgICAgeTogZCA9PiBkLnMyNWQsXG4gICAgICAgIGZpbGw6IGQgPT4ge1xuICAgICAgICBjb25zdCB2YWwgPSBkLnMyNWQ7XG4gICAgICAgIGlmICh2YWwgPT09IDApIHJldHVybiBcIiNkOWQ5ZDlcIjtcbiAgICAgICAgaWYgKHZhbCA8IDIpIHJldHVybiBcIiNmZmQ3MDBcIjtcbiAgICAgICAgaWYgKHZhbCA+PSAyKSByZXR1cm4gXCIjZmY3NjAwXCI7XG4gICAgICAgIHJldHVybiBcIiM2NzAwMGRcIjsgLy8gPjRcbiAgICAgICAgXG4gICAgICB9XG4gICAgfSksXG4gICAgUGxvdFRhdXgudGV4dChzb3J0ZWRfczI1ZCwge1xuICAgICAgeDogZCA9PiBkLm5vbSxcbiAgICAgIHk6IGQgPT4gZC5zMjVkLFxuICAgICAgdGV4dDogZCA9PiBkLnMyNWQudG9Mb2NhbGVTdHJpbmcoXCJmci1GUlwiKSxcbiAgICAgIGR5OiAtOCxcbiAgICAgIGZvbnRTaXplOiA5LFxuICAgICAgZmlsbDogXCJibGFja1wiLFxuICAgICAgdGV4dEFuY2hvcjogXCJtaWRkbGVcIlxuICAgIH0pXG4gIF0sXG4gIHk6IHtcbiAgICBncmlkOiB0cnVlLFxuICAgIGxhYmVsOiBcIk5vbWJyZSBkZSBzdGF0aW9ucyBk4oCZYWxpbWVudGF0aW9uIGVuIGVhdSBwb3RhYmxlIChBRVApIGVuIHpvbmUgaW5vbmRhYmxlXCIsXG4gICAgZG9tYWluOiBbMCwgTWF0aC5tYXgoLi4uc29ydGVkX3MyNWQubWFwKGQgPT4gZC5zMjVkKSldLFxuICAgIHRpY2tGb3JtYXQ6IGQgPT4gZC50b0xvY2FsZVN0cmluZyhcImZyLUZSXCIsIHsgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAwIH0pXG4gIH0sXG4gIHg6IHtcbiAgICBsYWJlbDogXCJDb21tdW5lXCIsXG4gICAgdGlja1JvdGF0ZTogLTQ1LFxuICAgIGxhYmVsQW5jaG9yOiBcInJpZ2h0XCJcbiAgfSxcbiAgc3R5bGU6IHtcbiAgICBmb250U2l6ZTogXCIxMXB4XCIsXG4gICAgZm9udEZhbWlseTogXCJzYW5zLXNlcmlmXCIsXG4gICAgZm9udFdlaWdodDogXCJib2xkXCJcbiAgfSxcbiAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoICogMC45NSxcbiAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjY1LFxuICBtYXJnaW5Cb3R0b206IDEyMCxcbiAgbWFyZ2luVG9wOiA1MCxcbiAgbWFyZ2luTGVmdDogODBcbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGBcblxuPHRhYmxlIHN0eWxlPVwid2lkdGg6OTAlOyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyBib3JkZXI6MXB4IHNvbGlkOyB0ZXh0LWFsaWduOmNlbnRlcjsgbWFyZ2luOmF1dG87XCI+XG4gIDxjb2xncm91cD5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoyMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoyMCU7XCI+XG4gIDwvY29sZ3JvdXA+XG4gIDx0cj5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7XCIgY29sc3Bhbj1cIjJcIj5OdW3DqXJvIGQnaW5kaWNhdGV1cjwvdGg+XG4gICAgPHRoIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5JbmQyLzVkPC90aD5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7XCI+RGF0ZSBkZSBtaXNlIMOgIGpvdXI8L3RoPlxuICAgIDx0aCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+MzEvMDUvMjAyNTwvdGg+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6I0JFREJFODsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+SW50aXR1bMOpPC90ZD5cbiAgICA8dGQgY29sc3Bhbj1cIjNcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+Tm9tYnJlIGRlIHN0YXRpb25zIGTigJlhbGltZW50YXRpb24gZW4gZWF1IHBvdGFibGUgKEFFUCkgZW4gem9uZSBpbm9uZGFibGU8L3RkPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPk9iamVjdGlmIGRlIGxhIFNOR1JJPC90ZD5cbiAgICA8dGQgY29sc3Bhbj1cIjNcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+T2JqZWN0aWYgbsKwMiA6IFN0YWJpbGlzZXIgw6AgY291cnQgdGVybWUgZXQgcsOpZHVpcmUgw6AgbW95ZW4gdGVybWUgbGUgY2/Du3QgZGVzIGRvbW1hZ2VzIGxpw6lzIMOgIGzigJlpbm9uZGF0aW9uPC90ZD5cbiAgPC90cj5cbiAgPHRyPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjojQkVEQkU4OyBib3JkZXI6MXB4IHNvbGlkOyBmb250LXdlaWdodDogYm9sZDtcIj5BeGUgZGUgdnVsbsOpcmFiaWxpdMOpPC90ZD5cbiAgICA8dGQgY29sc3Bhbj1cIjNcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+QXhlIDIvMiBMZXMgZG9tbWFnZXMgYXUgcGF0cmltb2luZTwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6I0JFREJFODsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+U291cmNlIGRlIHZ1bG7DqXJhYmlsaXTDqTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPlMyLzUgRG9tbWFnZXMgw6AgbOKAmWVudmlyb25uZW1lbnQgOiBjaGFycmlhZ2UgZGUgcG9sbHV0aW9ucyBldCBkw6ljaGV0czwvdGQ+XG4gIDwvdHI+XG48L3RhYmxlPlxuXG48YnI+XG5cbjx0YWJsZSBzdHlsZT1cIndpZHRoOjkwJTsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgYm9yZGVyOjFweCBzb2xpZDsgdGV4dC1hbGlnbjpjZW50ZXI7IG1hcmdpbjphdXRvO1wiPlxuICA8Y29sZ3JvdXA+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoyMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjIwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MjAlO1wiPlxuICA8L2NvbGdyb3VwPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPk1vZGFsaXTDqXMgZHUgY2FsY3VsPC90ZD5cbiAgICA8dGQgY29sc3Bhbj1cIjNcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+TGEgY291Y2hlIGRlcyBzdGF0aW9ucyBBRVAgZXN0IGNyb2lzw6llIGF2ZWMgbGEgem9uZSBpbm9uZGFibGUgKGhhdXRldXIgPiAwKSBldCBsZSByw6lzdWx0YXQgZXN0IGFncsOpZ8OpIMOgIGxhIGNvbW11bmUuPC90ZD5cbiAgPC90cj5cbiAgPHRyPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjojQkVEQkU4OyBib3JkZXI6MXB4IHNvbGlkOyBmb250LXdlaWdodDogYm9sZDtcIj7DiWNoZWxsZSBkZSByZXByw6lzZW50YXRpb248L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Db21tdW5hbGU8L3RkPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPlBvaW50cyBkZSB2aWdpbGFuY2U8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5QYXMgZGUgcG9pbnQgZGUgdmlnaWxhbmNlLjwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6I0JFREJFODsgYm9yZGVyOjFweCBzb2xpZDsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+VGFibGUgY2libGU8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiM1wiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5wX29iajJfY291dF9kb21tYWdlcy5zMjVkX2NhcHRfYWVwX3ppPC90ZD5cbiAgPC90cj5cbiAgPHRyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPlZhcmlhYmxlcyBtb2JpbGlzw6llczwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPlp4IDogem9uZSBpbm9uZGFibGUsIDxicj5SZXMxIDogY2FwdGFnZXMgQUVQPC90ZD5cbiAgPC90cj5cbiAgPHRyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPkluZGljYXRldXIgY29tbXVuIFNMR1JJIFZpZW5uZS9DbGFpbjwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIzXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPk91aTwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbjwvdGFibGU+XG5cbjxicj5cblxuPHRhYmxlIHN0eWxlPVwid2lkdGg6OTAlOyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyBib3JkZXI6MXB4IHNvbGlkOyB0ZXh0LWFsaWduOmNlbnRlcjsgbWFyZ2luOmF1dG87XCI+XG4gIDxjb2xncm91cD5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoxMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjEwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoxMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjEwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICAgIDxjb2wgc3R5bGU9XCJ3aWR0aDoxMCU7XCI+XG4gICAgPGNvbCBzdHlsZT1cIndpZHRoOjEwJTtcIj5cbiAgICA8Y29sIHN0eWxlPVwid2lkdGg6MTAlO1wiPlxuICA8L2NvbGdyb3VwPlxuXG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjEwXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7IGZvbnQtd2VpZ2h0OiBib2xkO1wiPkRvbm7DqWVzIHNvdXJjZXM8L3RkPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRoIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjojQkVEQkU4OyBib3JkZXI6MXB4IHNvbGlkO1wiIGNvbHNwYW49XCIyXCI+RMOpc2lnbmF0aW9uPC90aD5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7XCI+TWlsbMOpc2ltZTwvdGg+XG4gICAgPHRoIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjojQkVEQkU4OyBib3JkZXI6MXB4IHNvbGlkO1wiPk5hdGlvbmFsZS9sb2NhbGU8L3RoPlxuICAgIDx0aCBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6I0JFREJFODsgYm9yZGVyOjFweCBzb2xpZDtcIj5Gb3JtYXQ8L3RoPlxuICAgIDx0aCBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6I0JFREJFODsgYm9yZGVyOjFweCBzb2xpZDtcIj5UeXBlPC90aD5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7XCIgY29sc3Bhbj1cIjJcIj5Qcm9kdWN0ZXVyPC90aD5cbiAgICA8dGggc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiNCRURCRTg7IGJvcmRlcjoxcHggc29saWQ7XCIgY29sc3Bhbj1cIjJcIj5Ob20gZmljaGllcjwvdGg+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+Wm9uZSBpbm9uZGFibGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+MjAxOTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Mb2NhbGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+U2hhcGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+UG9seWdvbmU8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5DZXJlbWE8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5aeF96b25lX2lub25kYWJsZS5zaHA8L3RkPlxuICA8L3RyPlxuICA8dHI+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkNhcHRhZ2VzIEFFUDwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj4yMDIwPC90ZD5cbiAgICA8dGQgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkxvY2FsZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5TaGFwZTwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Qb2ludDwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPkFSUyBOQTwvdGQ+XG4gICAgPHRkIGNvbHNwYW49XCIyXCIgc3R5bGU9XCJib3JkZXI6MXB4IHNvbGlkO1wiPmNhcHRhZ2VfYWVwLnNocDwvdGQ+XG4gIDwvdHI+XG4gIDx0cj5cbiAgICA8dGQgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+Q29tbXVuZXMgKEJEVE9QTyk8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+MjAyMDwvdGQ+XG4gICAgPHRkIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5OYXRpb25hbGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+U2hhcGU8L3RkPlxuICAgIDx0ZCBzdHlsZT1cImJvcmRlcjoxcHggc29saWQ7XCI+UG9seWdvbmU8L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5JR048L3RkPlxuICAgIDx0ZCBjb2xzcGFuPVwiMlwiIHN0eWxlPVwiYm9yZGVyOjFweCBzb2xpZDtcIj5Db21tdW5lLnNocDwvdGQ+XG4gIDwvdHI+XG48L3RhYmxlPlxuXG5cbmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2xpZGVyX3MyNWQnKSJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/website\.quarto\.pub\/eptb_vienne");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Site créé avec <a href="https://quarto.org/">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
<p>©CEREMA</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://fr.linkedin.com/company/cerema">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/ceremacom">
      <i class="bi bi-twitter-x" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/@cerema3139">
      <i class="bi bi-youtube" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>